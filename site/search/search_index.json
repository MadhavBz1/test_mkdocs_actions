{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"IBM Cloud Pak for Business Automation Health Check","text":"<p>This repo contains the information regarding how to perform the health check for IBM Cloud Pak for Business Automation (CP4BA).</p> <p>Health Checks are a diagnostic tool designed to monitor and assess the health of your IBM Cloud Pak for Business Automation environment. It helps system administrators identify and troubleshoot potential issues within the system. By leveraging these diagnostic tools, system administrators can ensure that their IBM Cloud Pak for Business Automation environment remains healthy, efficient, and reliable.</p> <p>Unless specified, all the information applies to version 21.0.3 and later.</p> <ul> <li>For CP4BA container version (Certified Kubernetes / OpenShift), go to CP4BA Container Health Check.</li> <li>For CP4BA on-premise version, go to CP4BA On-premise Health Check.</li> </ul> <p>There are some useful tools for healch check, please refer to Health Check Tools.</p>"},{"location":"Container/","title":"IBM Cloud Pak for Business Automation Health Check (Container version)","text":"<p>This page contains the information regarding how to perform the health check for IBM Cloud Pak for Business Automation (CP4BA).</p> <p>Unless specified, all the information applies to version 21.0.3 and later.</p>"},{"location":"Container/#table-of-contents","title":"Table of Contents","text":"<ul> <li>0. Preparation</li> <li>1. Infrastructure and Environment</li> <li>2. Installation and Configuration</li> <li>3. Component Health</li> <li>4. Security and Authentication</li> <li>5. Upgrade and Patch Management</li> <li>6. Database and Storage</li> <li>7. Troubleshooting</li> <li>8. Backup and Recovery</li> </ul>"},{"location":"Container/#mustgather-tool","title":"Mustgather tool","text":"<p>IBM provides Mustgather tool to collect the troubleshooting data for Cloud Pak for Business Automation. It can grab lots of information including configuration and logs. </p> <p>For more information, please refer to:</p> <ul> <li>Mustgather: Collecting data to diagnose issues with IBM Cloud Pak for Business Automation</li> <li>Gathering deployment information and logs from Cloud Pak for Business Automation 23.0.1</li> </ul>"},{"location":"Container/#reference","title":"Reference","text":"<p>There are some existing tools. </p> <ul> <li>There's a new script <code>cp4a-post-install.sh</code> available since 22.0.2.</li> <li>Bringup cloudpak checker: https://github.ibm.com/cloudpakbringup/cloudpak-checker</li> <li>ibm-health-check-operator: https://github.com/IBM/ibm-healthcheck-operator</li> <li>IBM Foundational services (AKA Common services) healthcheck: https://github.ibm.com/pmara/cpfshealthcheck</li> </ul>"},{"location":"Container/0-Preparation/","title":"Preparation","text":""},{"location":"Container/0-Preparation/#0-preparation","title":"0. Preparation","text":"<p>To perform the health check, we need prepare the following.</p> <ul> <li>A Linux machine which can connect to the OpenShift cluster. It's better to be Linux as some scripts provided in this repo can only work with Linux.</li> <li><code>jq</code> utility needs to be installed.</li> <li>OpenShift administrator account.</li> <li>OpenShift Command Line Interface tool. Please install the version that matches the OCP cluster. You can download it from OCP Web Console, or https://mirror.openshift.com/pub/openshift-v4/clients/ocp/. </li> </ul> <p> </p> <p>Extract it and move the <code>oc</code> and <code>kubectl</code> commands to a directory which is in your PATH (e.g. /usr/bin).</p> <p>For more information about the OCP version and compatible CLI, please refer to Getting started with the OpenShift CLI.</p>"},{"location":"Container/0-Preparation/#login-to-ocp-cluster-using-command-line","title":"Login to OCP cluster using command line","text":"<p>First login to OCP Web Console, then click the User on the top right and select <code>Copy login command</code>. </p> <p>Click <code>Display Token</code> and copy the command under <code>Log in with this token</code>. Paste it in the command line.</p>"},{"location":"Container/1-InfraEnv/","title":"Infra&Env","text":""},{"location":"Container/1-InfraEnv/#1-infrastructure-and-environment","title":"1. Infrastructure and Environment","text":""},{"location":"Container/1-InfraEnv/#11-confirm-the-products-installed-is-still-supported","title":"1.1 Confirm the products installed is still supported","text":"<p>Check the Cloud Pak for Business Automation Support Lifecycle to make sure the version installed is still supported. </p> <ul> <li>18.x - 23.x: https://www.ibm.com/support/pages/ibm-cloud-pak-business-automation-software-support-lifecycle-addendum</li> <li>24.0: https://www.ibm.com/support/pages/node/7157023</li> </ul> <p>Consider to upgrade to a new release if it's already end of support.</p>"},{"location":"Container/1-InfraEnv/#12-check-the-compatibility","title":"1.2 Check the Compatibility","text":"<p>CP4BA comes with some dependencies, such as database, directory server, elasticsearch, Kafka etc. We need check the version compatibility only if customer use external dependencies, e.g. they have their own postgresql database and don't use the one shipped with CP4BA.</p> <p>Check Cloud Pak for Business Automation System Requirements for detailed compatibility report.</p>"},{"location":"Container/1-InfraEnv/#13-verify-the-underlying-infrastructure","title":"1.3 Verify the underlying infrastructure","text":"<p>Cloud Pak for Business Automation deploys on Red Hat OpenShift Container Platform (OCP). While OCP administrator should perform regular health check on it, we also need check the nodes to make sure they are in healthy state.</p> <p>Follow this document to check OCP.</p>"},{"location":"Container/1-OpenShift/","title":"OpenShift cluster health check","text":""},{"location":"Container/1-OpenShift/#openshift-cluster-health-check","title":"OpenShift cluster health check","text":"<p>OpenShift administrator should perform regular health check on the entire cluster. We only need focus on the namespaces/projects CP4BA is using.</p> <ul> <li>For CP4BA 21.0.3, Common Service is deployed in <code>ibm-common-services</code> namespace.</li> <li>Starting from CP4BA 22.0.1, Common Service can be deployed together with CP4BA in one namespace.</li> <li>CP4BA may also use other namespaces, e.g. postgresql, elasticsearch.</li> </ul>"},{"location":"Container/1-OpenShift/#overview","title":"Overview","text":"<p>After logging in to OCP Web Console, we will see the <code>Overview</code> page which shows basic information of the cluster.</p> <ul> <li>in <code>Details</code> section you can find the cluster version.</li> </ul> <p></p> <ul> <li>in <code>Status</code> section you can see the cluster health summary.</li> </ul> <p></p> <ul> <li>in <code>Cluster inventory</code> section you will find the pod status summary.</li> </ul> <p></p> <ul> <li>in <code>Cluster utilization</code> section you can see the resource utilization. Can be filtered by node type (master/worker) and time range.</li> </ul> <p></p>"},{"location":"Container/1-OpenShift/#node","title":"Node","text":"<p>On OCP Web Console, navigate to <code>Compute</code> - <code>Nodes</code>, it will show the summary of all the nodes. Make sure all nodes are in Ready state.</p> <p></p> <p>This can also be done by using script.</p> <pre><code>oc adm top nodes\n\nNAME       CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%   \nmaster01   1386m        8%     10056Mi         32%       \nmaster02   1783m        11%    9801Mi          31%       \nmaster03   1655m        10%    11136Mi         35%       \nworker01   2281m        7%     13343Mi         21%       \nworker02   1094m        3%     37251Mi         58%       \nworker03   2446m        7%     20529Mi         32%       \nworker04   3781m        12%    36771Mi         58%   \n</code></pre> <p>Click a node you will see its details. In <code>Status</code> section check any warning message. For example, the picture below shows that this node's CPU &amp; memory are overcommitted. Under high work load the pods may have performance issues. Click the number to see the breakdown.</p> <p></p> <p>We can also check the details by using <code>oc describe node</code> command.</p> <pre><code>oc describe node worker04\n\n...\nNon-terminated Pods:                       (51 in total)\n  Namespace                                Name                                                      CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE\n  ---------                                ----                                                      ------------  ----------  ---------------  -------------  ---\n  ibm-cp4ba                                icp4adeploy-odm-decisioncenter-84ddc99498-thsgt           1 (3%)        1 (3%)      4Gi (6%)         8Gi (12%)      26d\n  ibm-cp4ba                                process-mining-bpa-78f9b69cdb-d7cv8                       500m (1%)     16 (50%)    2Gi (3%)         16Gi (25%)     150d\n  ibm-cp4ba                                process-mining-mongo-db-78b5d65bd4-sggxz                  100m (0%)     4 (12%)     200Mi (0%)       8000Mi (12%)   174d\n  ibm-cp4ba                                process-mining-taskbuilder-6f4db58c4-rkqth                100m (0%)     16 (50%)    200Mi (0%)       16Gi (25%)     150d\n  ibm-cp4ba                                process-mining-taskminer-nginx-5b7b95ffcd-nvhjk           200m (0%)     32 (101%)   400Mi (0%)       32Gi (51%)     150d\n  ibm-cp4ba                                process-mining-taskprocessor-f4864474f-p4krh              100m (0%)     16 (50%)    200Mi (0%)       16Gi (25%)     174d\n\nAllocated resources:\n  (Total limits may be over 100 percent, i.e., overcommitted.)\n  Resource           Requests       Limits\n  --------           --------       ------\n  cpu                12314m (39%)   108260m (343%)\n  memory             24983Mi (39%)  122612Mi (193%)\n  ephemeral-storage  31420Mi (11%)  167888Mi (60%)\n  hugepages-1Gi      0 (0%)         0 (0%)\n  hugepages-2Mi      0 (0%)         0 (0%)\n</code></pre> <p>Here we can see process mining pods have very large resource limits. It's better to move them to another worker node.</p>"},{"location":"Container/2-CP4BAOperators/","title":"Cloud Pak for Business Automation operators","text":""},{"location":"Container/2-CP4BAOperators/#cloud-pak-for-business-automation-operators","title":"Cloud Pak for Business Automation operators","text":""},{"location":"Container/2-CP4BAOperators/#operator-status","title":"operator status","text":"<p>On OCP Web Console, navigate to <code>Operators</code> - <code>Installed Operators</code>, select the <code>ibm-common-services</code> project and CP4BA project, check the operator status.</p> <p></p> <p></p> <p>If any operator is not in <code>Succeeded</code> state, click it to open the details and check the messages on the bottom of the page (in <code>Conditions</code> section).</p> <p></p>"},{"location":"Container/2-CP4BAOperators/#operator-version","title":"Operator version","text":"<p>From the operator name you can find the version, e.g. <code>21.3.14</code> means 21.0.3 IF014. You can also find the version by using script.</p> <pre><code>oc get csv -n ibm-cp4ba\nNAME                                     DISPLAY                                      VERSION   REPLACES                                PHASE\ndb2u-operator.v1.1.11                    IBM Db2                                      1.1.11    db2u-operator.v1.1.10                   Succeeded\nibm-automation-core.v1.3.11              IBM Automation Foundation Core               1.3.11    ibm-automation-core.v1.3.7              Succeeded\nibm-automation-elastic.v1.3.10           IBM Elastic                                  1.3.10    ibm-automation-elastic.v1.3.6           Succeeded\nibm-automation-eventprocessing.v1.3.11   IBM Automation Foundation Event Processing   1.3.11    ibm-automation-eventprocessing.v1.3.7   Succeeded\nibm-automation-flink.v1.3.10             IBM Automation Foundation Flink              1.3.10    ibm-automation-flink.v1.3.6             Succeeded\nibm-automation-insightsengine.v1.3.10    IBM Automation Foundation Insights Engine    1.3.10    ibm-automation-insightsengine.v1.3.6    Succeeded\nibm-automation.v1.3.11                   IBM Automation Foundation                    1.3.11    ibm-automation.v1.3.7                   Succeeded\nibm-cloud-databases-redis.v1.4.3         IBM Operator for Redis                       1.4.3     ibm-cloud-databases-redis.v1.4.2        Succeeded\nibm-common-service-operator.v3.19.5      IBM Cloud Pak foundational services          3.19.5    ibm-common-service-operator.v3.19.4     Succeeded\nibm-cp4a-operator.v21.3.14               IBM Cloud Pak for Business Automation        21.3.14   ibm-cp4a-operator.v21.3.13              Succeeded\nibm-cp4a-wfps-operator.v21.3.14          Workflow Process Service                     21.3.14   ibm-cp4a-wfps-operator.v21.3.13         Succeeded\n</code></pre> <p>Starting from CP4BA 21.0.3 IF007, you can \"pin\" the version of CP4BA along with all its dependencies (i.e., IBM Automation Foundation (IAF), and IBM Foundational Services (aka IBM Common Services)).  In other words, your deployment will remain at a specific version of CP4BA, IAF, and IBM Common Services until you are ready to apply a new interim fix. It's important to make sure the versions are match, i.e. CP4BA 21.0.3 supports Common Service 3.19. </p> <p>Customer may use a higher version of Common Service and cause some issues. For example, the CP4BA version is 21.0.3 IF017, but the Common Service version is 3.23. It's not supported.</p>"},{"location":"Container/2-CP4BAOperators/#find-the-versions-from-ifix-readme","title":"Find the versions from iFix README","text":"<p>Each iFix has a README document. You can find the links from  Cloud Pak for Business Automation Fix List . </p> <p>Open a Readme document and find the texts like below.</p> <pre><code>This interim fix contains the following version of Cloud Pak for Business Automation, Automation Foundation, and Cloud Pak Foundational Services:\n\n    Cloud Pak for Business Automation \u2013 21.0.3-IF017\n    Automation Foundation \u2013 1.3.12\n    Cloud Pak Foundational Services \u2013 3.19.7\n\n</code></pre>"},{"location":"Container/2-CP4BAOperators/#find-the-versions-from-case-package","title":"Find the versions from CASE package","text":"<p>You can also find the versions in CASE package. </p> CASE package version CP4BA version 5.0 23.0.1 4.1 22.0.2 4.0 22.0.1 3.2 21.0.3 3.1 21.0.2 3.0 21.0.1 <p>Download the CASE package, extract it and find <code>ibm-cp-automation\\inventory\\cp4aOperatorSdk\\files\\deploy\\crs\\cert-k8s-&lt;version&gt;.tar</code>, extract it and find <code>cert-kubernetes\\descriptors\\op-olm\\catalog_source.yaml</code>. You will find all the operator versions in it.</p>"},{"location":"Container/2-CP4BAOperators/#operator-version-compatibility","title":"Operator version compatibility","text":"<p>Here are some references.   - CP4BA: including all CP4BA operators, e.g. Content, ADS, WfPS, PFS, DPE, ODM etc.   - BTS: Business Team Service operator   - Cert: Certificate Manager operator   - CNPG: Cloud Native PostgreSQL operator   - CPFS: Cloud Pak Foundational Services operator, including Common Service operator, Common UI operator and foundation operator   - Events: Events Operator   - ES: Elastic Operator   - Flink: Flink operator   - IAF: Automation Foundation operator   - IE: Insights Engine operator   - License: License Manager operator   - Mongo: MongoDB operator   - Redis: IBM Redis operator   - Zen: Zen operator</p> CP4BA BTS Cert CNPG CPFS Events ES Flink IAF IE License Mongo Redis Zen 23.0.1.4 3.30.0 4.2.0 4.14.0 4.2.0 1.3.14 1.3.14 - 23.1.4 4.2.0 23.0.1.2 3.28.0 4.1.0 1.18.5 4.1.0 4.7.0 1.3.14 1.3.14 - 23.1.2 4.1.0 4.1.0 1.6.2 5.0.1 22.0.2.6 3.26.0 - 1.18.1 3.23.4 4.6.1 1.3.13 1.3.13 1.3.14 1.3.13 - 1.18.4 1.4.3 1.8.5 21.0.3.14 - 3.19.5 1.3.11 1.3.10 1.3.10 1.3.11 1.3.10 - 1.4.3"},{"location":"Container/2-CP4BAStatus/","title":"Cloud Pak for Business Automation cluster","text":""},{"location":"Container/2-CP4BAStatus/#cloud-pak-for-business-automation-cluster","title":"Cloud Pak for Business Automation cluster","text":""},{"location":"Container/2-CP4BAStatus/#the-operators","title":"The operators","text":"<p>Before version 22.0.1, we use single operator to deploy Cloud Pak for Business Automation. That's <code>IBM Cloud Pak for Business Automation</code> in the <code>Installed Operators</code> list. </p> <p>Starts from verion 22.0.1, we have multiple operators. They are: - IBM Cloud Pak for Business Automation (CP4BA) multi-pattern (CP4BA operator) - IBM CP4BA Process Federation Server (PFS operator) - IBM CP4BA FileNet Content Manager (Content operator)</p> <p>There may be more operators in the future.</p>"},{"location":"Container/2-CP4BAStatus/#cp4ba-custom-resource","title":"CP4BA Custom Resource","text":"<p>No matter how many CP4BA operators we have, you can always find the deployment YAML (Custom Resource, CR) file in the CP4BA operator.</p> <p>Click CP4BA operator in <code>Installed Operators</code> list and switch to <code>CP4BA deployment</code> tab. You can see the ICP4ACluster listed. The status should be <code>Ready, Running</code>.</p> <p></p> <p>Click it and switch to <code>YAML</code> view, you will find the CR YAML. We will talk about the CR later. Here just focus on the deployment status.</p> <p></p>"},{"location":"Container/2-CP4BAStatus/#cp4ba-deployment-status-overview","title":"CP4BA deployment status overview","text":"<p>In <code>status</code> section of CR YAML, you can find the deployment status for each component in CP4BA. For example, here are the status for <code>Workflow Authoring</code> and <code>BAI</code>.</p> <pre><code>    workflow-authoring:\n      adminSecret: ibm-bawaut-admin-secret\n      reconcile: Finished\n      service: Ready\n...\n    bai:\n      bai_deploy_status: Ready\n      conditions:\n        lastTransitionTime: '2023-03-08T06:28:57Z'\n        message: BAI installation finished.\n        reason: BAI-Deployment\n        status: 'True'\n        type: Ready\n      insightsEngine: Ready\n</code></pre> <p>And here you can see tm (Task Manager) is not installed.</p> <pre><code>    tm:\n      lastTransitionTime: '2023-03-08T06:28:57Z'\n      message: ''\n      reason: ''\n      tmDeployment: NotInstalled\n      tmRoute: NotInstalled\n      tmService: NotInstalled\n      tmStorage: NotInstalled\n</code></pre> <p>In <code>status.conditions</code> section you can see the operator status, like:</p> <pre><code>    - message: ''\n      reason: Successful\n      status: 'True'\n      type: Ready\n    - message: Running reconciliation\n      reason: Running\n      status: 'True'\n      type: Running\n</code></pre>"},{"location":"Container/2-CP4BAStatus/#operator-log","title":"Operator log","text":"<p>If any installed component has <code>NotReady</code> state, you can check the operator log to find any potential cause. Starting from 22.0.1, please check the correct operator, for example, if you find issues in ECM components (cpe, navigator) you should check Content operator log.</p> <p>We have several ways to check the log.</p> <ol> <li>From OCP Web Console, navigate to Workloads - Pods. Find operator pod. Use <code>ibm-operator</code> as the filter.    </li> </ol> <p>Click the pod and switch to <code>Logs</code> tab, you can either check the log in the window (click <code>Expand</code> to view it in full screen), or click <code>Download</code> to download it to your local machine and check it using any text editor you like.</p> <ol> <li>Click operator pod and switch to <code>Terminal</code> view, you will get a terminal window which connects to the operator pod. Change the directory to <code>/logs/&lt;operator pod name&gt;/ansible-operator/runner/icp4a.ibm.com/v1/ICP4ACluster/ibm-cp4ba/icp4adeploy/artifacts</code>, you can see the log directories for each reconcilation.</li> </ol> <p><code>sh-4.4$ cd /logs/ibm-cp4a-operator-54dd85fb68-8l58k/ansible-operator/runner/icp4a.ibm.com/v1/ICP4ACluster/ibm-cp4ba/icp4adeploy/artifacts/    sh-4.4$ ls -lrt    total 0    drwxr-xr-x. 2 1000710000 root 20 Feb  2 06:16 reconcile-0    drwxr-xr-x. 2 1000710000 root 20 Feb  2 07:51 reconcile-1    drwxr-xr-x. 2 1000710000 root 20 Feb  2 09:27 reconcile-2    drwxr-xr-x. 2 1000710000 root 20 Feb  2 11:03 reconcile-3    drwxr-xr-x. 2 1000710000 root 20 Feb  2 12:37 reconcile-4    drwxr-xr-x. 2 1000710000 root 20 Feb  2 14:12 reconcile-5    drwxr-xr-x. 2 1000710000 root 20 Feb  2 15:49 reconcile-6    drwxr-xr-x. 2 1000710000 root 20 Feb  2 17:24 reconcile-7    drwxr-xr-x. 2 1000710000 root 20 Feb  2 19:01 reconcile-8    drwxr-xr-x. 2 1000710000 root 20 Feb  2 20:37 reconcile-9    drwxr-xr-x. 2 1000710000 root 20 Mar  9 01:49 latest</code></p> <ol> <li>If you are able to access the PV (e.g. you are using NFS and you can access the directories on NFS), you can find the log files there, e.g. <code>/nfs/ibm-cp4ba-cp4a-shared-log-pvc-pvc-66a53048-c74c-40e4-aa59-daebfadec884/ibm-cp4a-operator-54dd85fb68-8l58k/ansible-operator/runner/icp4a.ibm.com/v1/ICP4ACluster/ibm-cp4ba/icp4adeploy/artifacts</code>.</li> </ol> <p>TIP: search <code>fatal</code> or <code>FAILED!</code> in operator log to locate the issue quickly.</p>"},{"location":"Container/2-CP4BAStatus/#jobs","title":"Jobs","text":"<p>During the deployment operator will create some Jobs. Those jobs should be in <code>Completed</code> state. On OCP Web Console, navigate to <code>Workloads</code> - <code>Jobs</code> and check the status.</p> <p>This can also be done using scripts.</p> <pre><code>oc get jobs\nNAME                                                              COMPLETIONS   DURATION   AGE\ncreate-secrets-job                                                1/1           55s        107d\niaf-insights-engine-application-setup                             1/1           15s        107d\niaf-insights-engine-event-forwarder                               1/1           77s        32d\niaf-zen-tour-job                                                  1/1           30s        107d\niam-config-job                                                    1/1           2m18s      107d\nicp4adeploy-bai-bpmn                                              1/1           28s        21d\nicp4adeploy-bai-content                                           1/1           27s        21d\nicp4adeploy-bai-icm                                               1/1           26s        21d\nicp4adeploy-bai-setup                                             1/1           102s       92d\nicp4adeploy-ban-job                                               1/1           89s        107d\nicp4adeploy-bastudio-bootstrap                                    1/1           2m30s      107d\nicp4adeploy-bastudio-ltpa                                         1/1           9s         272d\nicp4adeploy-bastudio-zen-translation                              1/1           40s        107d\nicp4adeploy-odm-oidc-job-registration                             1/1           25s        107d\nicp4adeploy-pbk-ae-db-job                                         1/1           52s        107d\nicp4adeploy-rr-backup-27972120                                    1/1           11s        3m4s\nicp4adeploy-viewone-autoimport-job                                1/1           19s        107d\nicp4adeploy-workflow-authoring-baw-basimport-job                  1/1           53s        107d\nicp4adeploy-workflow-authoring-baw-case-init-job                  1/1           2m34s      107d\nicp4adeploy-workflow-authoring-baw-content-init-job               1/1           33s        107d\nicp4adeploy-workflow-authoring-baw-db-init-job                    1/1           4m44s      107d\nicp4adeploy-workflow-authoring-baw-db-init-job-pfs                1/1           16s        107d\nicp4adeploy-workflow-authoring-baw-ltpa                           1/1           22s        107d\nicp4adeploy-workflow-authoring-baw-workplace-job                  1/1           47s        107d\nicp4adeploy-workspace-aae-ae-db-job                               1/1           47s        107d\nsetup-nginx-job                                                   1/1           42s        107d\nzen-metastore-backup-cron-job-27971040                            1/1           28s        18h\nzen-metastore-backup-cron-job-27971520                            1/1           37s        10h\nzen-metastore-backup-cron-job-27972000                            1/1           31s        123m\nzen-metastoredb-certs                                             1/1           6s         107d\nzen-metastoredb-init                                              1/1           59s        107d\nzen-post-requisite-job                                            1/1           5s         272d\nzen-pre-requisite-job                                             1/1           13s        107d\n</code></pre> <p>Some jobs are executed regularly, e.g. <code>icp4adeploy-rr-backup</code>. </p> <p>Please pay attention to the init jobs. If they are not completed, the environment may have some severe issues.</p>"},{"location":"Container/2-CPFS/","title":"IBM Automation Foundational Services","text":""},{"location":"Container/2-CPFS/#ibm-automation-foundational-services","title":"IBM Automation Foundational Services","text":"<p>Note: this page applies to 21.0.3 and 22.0.x only. IAF is removed since 23.0.1.</p> <p>Operators deploy some dependencies which use Automation Foundational Services. We need make sure they are in <code>Ready</code> state. Switch to CP4BA project.</p>"},{"location":"Container/2-CPFS/#ibm-automation-foundation-core-operator","title":"IBM Automation Foundation Core operator","text":"<p>Find <code>IBM Automation Foundation Core</code> operator in <code>Installed Operators</code> list. Click it and switch to <code>All instances</code> tab. Here we can see several resources.</p> <p></p> <ul> <li>AutomationUIConfig: status should be <code>Ready</code>.</li> <li>Cartridge: status should be <code>Ready, BedrockReady, ZenReady</code>. </li> </ul>"},{"location":"Container/2-CPFS/#ibm-automation-foundation-operator","title":"IBM Automation Foundation operator","text":"<p>Find <code>IBM Automation Foundation</code> operator in <code>Installed Operators</code> list. Click it and switch to <code>All Instances</code> tab. Here we can see several resources.</p> <p></p> <ul> <li>AutomationBase: status should be <code>Ready, KafkaReady, ElasticReady, ApicurioReady, CommonServicesReady</code>. </li> <li>CartridgeRequirements: status should be <code>Ready, ElasticUserReady, KafkaUserReady</code>.</li> </ul>"},{"location":"Container/2-CR/","title":"Cloud Pak for Business Automation Custom Resource (CR)","text":""},{"location":"Container/2-CR/#cloud-pak-for-business-automation-custom-resource-cr","title":"Cloud Pak for Business Automation Custom Resource (CR)","text":"<p>Cloud Pak for Business Automation is a hybrid platform with a comprehensive set of capabilities for automating your business. From the CR we can understand the deployment configuration.</p> <p>CR file has several sections like the picture below. </p> <p>Details please refer to Custom resoure configuration parameters.</p>"},{"location":"Container/2-CR/#shared_configuration","title":"shared_configuration","text":"<p>Check the following configurations.</p> <ul> <li><code>sc_deployment_type</code>: starter or production. Starter deployment is for evaluation purpose. See Cp4BA planning for details.</li> <li><code>sc_deployment_profile_size</code>: can be <code>small</code>, <code>medium</code> or <code>large</code>. We will discuss this in Deployment Profile Size section. </li> <li><code>sc_deployment_patterns</code> and <code>sc_optional_components</code>: what have been deployed.</li> <li><code>no_log</code> and <code>show_sensitive_log</code>: these two properties are un-documented. Set them to <code>false</code> and <code>true</code> will force operator to print extra logs, which is very useful sometimes. As it will print some sensitive information, please talk to customer before you apply the change.</li> <li><code>trusted_certificate_list</code>: the certificates in this list will be trusted by all the CP4BA components. Check it when you have SSL certificate issue.</li> </ul>"},{"location":"Container/2-CR/#ldap_configuration","title":"ldap_configuration","text":"<p>This section defines the connection properties to the LDAP server.</p>"},{"location":"Container/2-CR/#datasource_configuration","title":"datasource_configuration","text":"<p>This section defines the database connection information for: - ADP: dc_ca_datasource - ECM: dc_gcd_datasource and dc_os_datasources - ODM: dc_odm_datasource - Navigator: dc_icn_datasource</p> <p>Some datasources (e.g. Workflow datasource) are defined in their subsection (workflow_authoring_configuration / baw_configuration).</p>"},{"location":"Container/2-CR/#initialize_configuration","title":"initialize_configuration","text":"<p>This section defines the properties for FileNet Content Manager initialization. Check this section if you have issues regarding CPE/ObjectStore initialization.</p>"},{"location":"Container/2-InstallConfig/","title":"Installation and Configuration","text":""},{"location":"Container/2-InstallConfig/#2-installation-and-configuration","title":"2. Installation and Configuration","text":""},{"location":"Container/2-InstallConfig/#21-validate-cp4ba-operators","title":"2.1 Validate CP4BA Operators","text":"<p>Cloud Pak for Business Automation is deployed by several operators. Follow these steps to check the operator status.</p> <p>For more information about the operator, please refer to What are Red Hat OpenShift Operators?.</p>"},{"location":"Container/2-InstallConfig/#22-validate-cloud-pak-foundational-services-cpfs","title":"2.2 Validate Cloud Pak Foundational Services (CPFS)","text":"<p>Cloud Pak for Business Automation depends on Cloud Pak Foundational Services (CPFS). Follow these steps to check CPFS.</p> <p>For the CPFS itself, please refer to IBM Foundational services (AKA Common services) healthcheck.</p>"},{"location":"Container/2-InstallConfig/#23-validate-cp4ba-deployment","title":"2.3 Validate CP4BA Deployment","text":"<p>Cloud Pak for Business Automation is deployed using a resource called <code>ICP4ACluster</code>. We can find the deployment YAML and status by checking CP4BA operator.</p>"},{"location":"Container/2-InstallConfig/#24-custom-resource","title":"2.4 Custom Resource","text":"<p>We use a YAML file called <code>Custom Resource (CR)</code> to deploy Cloud Pak for Business Automation. Customer should maintain the history of this file to record the changes to CP4BA deployment. If customer don't have it you can find the latest version in CP4BA operator. </p> <p>Follow these steps to check CR.</p> <p>For more information regarding to CR, please refer to Understanding custom resources and patterns on IBM Knowledge Center.</p>"},{"location":"Container/3-ADP/","title":"Automation Document Processing","text":""},{"location":"Container/3-ADP/#automation-document-processing","title":"Automation Document Processing","text":"<p>Automation Document Processing (ADP) provides a tailored solution that reads your documents, extracts data, and refines and stores the data for use.</p> <p>ADP contains a few components, e.g. deep learning, ocr extraction, backend and frontend. Here's the pod list for example.</p> <pre><code>icp4adeploy-callerapi-f7d7fb9b6-b8kzb                    1/1     Running   0          9d\nicp4adeploy-callerapi-f7d7fb9b6-hs5qs                    1/1     Running   0          9d\nicp4adeploy-classifyprocess-classify-64775d6498-sv9s7    1/1     Running   0          9d\nicp4adeploy-classifyprocess-classify-64775d6498-vxqpc    1/1     Running   0          9d\nicp4adeploy-deep-learning-d489f7867-dj4jl                1/1     Running   0          9d\nicp4adeploy-deep-learning-d489f7867-hhw49                1/1     Running   0          9d\nicp4adeploy-natural-language-extractor-b4b649487-4lktq   1/1     Running   0          9d\nicp4adeploy-natural-language-extractor-b4b649487-jbfgw   1/1     Running   0          9d\nicp4adeploy-ocr-extraction-69c4cc7f88-d7s4x              1/1     Running   0          9d\nicp4adeploy-ocr-extraction-69c4cc7f88-q9hm2              1/1     Running   0          9d\nicp4adeploy-postprocessing-77c88d5859-959mf              1/1     Running   0          9d\nicp4adeploy-postprocessing-77c88d5859-vrks8              1/1     Running   0          9d\nicp4adeploy-processing-extraction-67485f647d-d4m9x       1/1     Running   0          9d\nicp4adeploy-processing-extraction-67485f647d-g62vh       1/1     Running   0          9d\nicp4adeploy-rabbitmq-ha-0                                1/1     Running   0          9d\nicp4adeploy-rabbitmq-ha-1                                1/1     Running   0          9d\nicp4adeploy-rabbitmq-ha-2                                1/1     Running   0          9d\nicp4adeploy-redis-ha-server-0                            2/2     Running   0          9d\nicp4adeploy-redis-ha-server-1                            2/2     Running   0          9d\nicp4adeploy-redis-ha-server-2                            2/2     Running   0          9d\nicp4adeploy-setup-55cb9b8bc8-h88hm                       1/1     Running   0          9d\nicp4adeploy-setup-55cb9b8bc8-kfzht                       1/1     Running   0          9d\nicp4adeploy-spbackend-b8dd5d454-f646x                    1/1     Running   0          9d\nicp4adeploy-spbackend-b8dd5d454-zh8hc                    1/1     Running   0          9d\nicp4adeploy-updatefiledetail-969c677b7-bj92v             1/1     Running   0          9d\nicp4adeploy-updatefiledetail-969c677b7-swzr9             1/1     Running   0          9d\n</code></pre>"},{"location":"Container/3-ADP/#adp-status","title":"ADP Status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section you can find the ADP status.</p> <ul> <li>ca (content analyzer)   <code>\"caDatabaseVerification\": \"Ready\",   \"caDeployment\": \"Successful\",   \"caRRRegistration\": \"Ready\",   \"caSecrets\": \"Ready\",   \"caService\": \"Ready\",   \"caStorageVerification\": \"Ready\",   \"caZenRegistration\": \"Ready\",   \"conditions\": {     \"lastTransitionTime\": \"2022-07-30T00:41:33Z\",     \"message\": \"Content Analyzer deploys successfully.\",     \"reason\": \"caDeployment\",     \"status\": \"True\",     \"type\": \"Successful\"</code></li> <li>viewone   <code>\"basViewoneImportJob\": \"Ready\",   \"viewoneDeployment\": \"Ready\",   \"viewoneRRIntegration\": \"Ready\",   \"viewoneRoute\": \"Ready\",   \"viewoneService\": \"Ready\",   \"viewoneStorage\": \"Ready\"</code></li> <li>gitgatewayService   <code>\"gitsvcDeployment\": \"Ready\",   \"gitsvcPersistentVolume\": \"Ready\",   \"gitsvcService\": \"Ready\",   \"lastTransitionTime\": \"2022-11-30T08:25:58Z\",   \"message\": \"\",   \"reason\": \"\"</code></li> <li>contentDesignerRepoAPI   <code>\"cdraDeployment\": \"Ready\",   \"cdraPersistentVolume\": \"Ready\",   \"cdraService\": \"Ready\"</code></li> <li>contentProjectDeploymentService   <code>\"cpdsDeployment\": \"Ready\",   \"cpdsPersistentVolume\": \"Ready\",   \"cpdsService\": \"Ready\",   \"cpdsZenInegration\": \"Ready\",   \"lastTransitionTime\": \"2022-11-30T08:25:58Z\",   \"message\": \"\",   \"reason\": \"\"</code></li> <li>contentDesignerService   <code>\"cdsDeployment\": \"Ready\",   \"cdsPersistentVolume\": \"Ready\",   \"cdsService\": \"Ready\"</code></li> </ul>"},{"location":"Container/3-ADS/","title":"Automation Decision Services","text":""},{"location":"Container/3-ADS/#automation-decision-services","title":"Automation Decision Services","text":"<p>Automation Decision Service (ADS) is the low code decision management capability. It has a few components like Mongo, Runtime and GitService. Here's the pod list for example.</p> <pre><code>icp4adeploy-ads-credentials-service-9bf45bcf6-8q2lt               1/1     Running     0          8d\nicp4adeploy-ads-download-service-6756d958cb-w4k5f                 1/1     Running     0          8d\nicp4adeploy-ads-embedded-build-service-749dbc9fb8-85djn           1/1     Running     0          8d\nicp4adeploy-ads-front-8dfb6f858-9f6l2                             1/1     Running     0          8d\nicp4adeploy-ads-git-service-589d886dfb-7phnc                      1/1     Running     0          8d\nicp4adeploy-ads-mongo-6ffb587799-kfwpl                            1/1     Running     0          8d\nicp4adeploy-ads-parsing-service-7667bf47f4-6dr66                  1/1     Running     0          8d\nicp4adeploy-ads-rest-api-758f57bb5c-wtt6f                         1/1     Running     0          8d\nicp4adeploy-ads-run-service-54cb4bf9d4-ljkhf                      1/1     Running     0          8d\nicp4adeploy-ads-runtime-service-57dddcf97f-rzx8h                  1/1     Running     0          8d\n</code></pre>"},{"location":"Container/3-ADS/#ads-status","title":"ADS status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section check ADS status.</p> <ul> <li>adsMongo   <code>\"adsMongoDeployment\": \"Ready\",   \"adsMongoService\": \"Ready\",   \"adsMongoStorage\": \"Ready\",   \"conditions\": []</code></li> <li>adsLtpaCreation   <code>\"adsLtpaCreationJob\": \"Ready\",   \"conditions\": []</code></li> <li>adsCredentialsService   <code>\"adsCredentialsServiceDeployment\": \"Ready\",   \"adsCredentialsServiceService\": \"Ready\",   \"conditions\": []</code></li> <li>adsRrRegistration   <code>\"adsRrRegistrationJob\": \"Ready\",   \"conditions\": []</code></li> <li>adsRuntimeService   <code>\"adsRuntimeServiceDeployment\": \"Ready\",   \"adsRuntimeServiceService\": \"Ready\",   \"adsRuntimeServiceZenIntegration\": \"Ready\",   \"conditions\": []</code></li> <li>adsGitService   <code>\"adsGitServiceDeployment\": \"Ready\",   \"adsGitServiceService\": \"Ready\",   \"conditions\": []</code></li> <li> <p>adsParsingService   <code>\"adsParsingServiceDeployment\": \"Ready\",   \"adsParsingServiceService\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsRestApi   <code>\"adsRestApiDeployment\": \"Ready\",   \"adsRestApiService\": \"Ready\",   \"adsRestApiZenIntegration\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsBuildService   <code>\"adsBuildServiceDeployment\": \"Ready\",   \"adsBuildServiceService\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsFront   <code>\"adsFrontDeployment\": \"Ready\",   \"adsFrontService\": \"Ready\",   \"adsFrontZenIntegration\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsRunService   <code>\"adsRunServiceDeployment\": \"Ready\",   \"adsRunServiceService\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsRuntimeBaiRegistration   <code>\"adsRuntimeBaiRegistrationJob\": \"Ready\",   \"conditions\": []</code></p> </li> <li> <p>adsDownloadService   <code>\"adsDownloadServiceDeployment\": \"Ready\",   \"adsDownloadServiceService\": \"Ready\",   \"adsDownloadServiceZenIntegration\": \"Ready\",   \"conditions\": []</code></p> </li> </ul>"},{"location":"Container/3-BAA/","title":"Business Automation Application","text":""},{"location":"Container/3-BAA/#business-automation-application","title":"Business Automation Application","text":"<p>Build low-code business applications using Application Designer, test them with Playback Application Engine and run them in Application Engine. These applications are available to users in IBM Business Automation Navigator.</p> <p>BAA includes the following components.</p> <ul> <li>Business Automation Application Designer (App Designer)</li> <li>Business Automation Application Playback Server (pbk server)</li> <li>Business Automation Application Engine (App Engine)</li> </ul> <p>For Development environment we have all three components. For Runtime environment we only have App Engine.</p> <p>Here's the pod list for example.</p> <pre><code>icp4adeploy-pbk-ae-deployment-7d5976fb44-45jn4             1/1     Running     0          9d\nicp4adeploy-pbk-ae-deployment-7d5976fb44-sf585             1/1     Running     0          9d\nicp4adeploy-workspace-aae-ae-deployment-7868b96454-k6667   1/1     Running     0          8d\nicp4adeploy-workspace-aae-ae-deployment-7868b96454-nrpr4   1/1     Running     0          8d\nicp4adeploy-workspace-aae-ae-deployment-7868b96454-vbfnf   1/1     Running     0          8d\nicp4adeploy-workspace-aae-ae-deployment-7868b96454-vr2rd   1/1     Running     0          8d\n</code></pre>"},{"location":"Container/3-BAA/#baa-status","title":"BAA Status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for BAA status.</p> <ul> <li> <p>app-engine   <code>\"instance_count\": \"1\"</code></p> </li> <li> <p>ae-icp4adeploy-workspace-aae   <code>\"adminSecret\": \"icp4adeploy-workspace-aae-app-engine-admin-secret\",   \"reconcile\": \"Finished\",   \"service\": \"Ready\"</code></p> </li> <li> <p>ae-icp4adeploy-pbk   <code>\"adminSecret\": \"playback-server-admin-secret\",   \"reconcile\": \"Finished\",   \"service\": \"Ready\"</code></p> </li> </ul>"},{"location":"Container/3-BAI/","title":"Business Automation Insights","text":""},{"location":"Container/3-BAI/#business-automation-insights","title":"Business Automation Insights","text":"<p>Business Automation Insights (BAI) is a platform-level component that provides visualization insights to business owners and that feeds a data lake to infuse artificial intelligence into Cloud Pak for Business Automation. Currently BAI can receive data from ECM, Workflow, ADS and ODM.</p> <p>Some components are deployed together with BAI, including Automation Foundation Insights Engine, Elastic Search, Kafka etc. Here's the sample pod list.</p> <pre><code>iaf-eventprocessing-operator-controller-manager-5b6964d7bflxhlg   1/1     Running     28 (2d9h ago)      111d\niaf-flink-operator-controller-manager-bcbfb976d-5q4lp             1/1     Running     6                  111d\niaf-insights-engine--7fc4-eve-29ee-ep-jobmanager-0                2/2     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-0               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-1               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-2               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-3               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-4               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-5               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-6               1/1     Running     0                  36d\niaf-insights-engine--7fc4-eve-29ee-ep-taskmanager-7               1/1     Running     0                  36d\niaf-system-apicurio-655558d6c5-5596x                              1/1     Running     0                  37d\niaf-insights-engine-cockpit-5c476b84dd-k5vmg                      1/1     Running     1 (16d ago)        36d\niaf-insights-engine-cockpit-5c476b84dd-srp2f                      1/1     Running     1 (16d ago)        36d\niaf-insights-engine-management-b94d6bbf5-987bq                    2/2     Running     0                  36d\niaf-insights-engine-management-b94d6bbf5-ghwz9                    2/2     Running     0                  36d\niaf-insights-engine-operator-controller-manager-6c69978848fnp24   1/1     Running     2 (66d ago)        111d\niaf-system-elasticsearch-es-data-0                                2/2     Running     0                  34h\niaf-system-elasticsearch-es-data-1                                2/2     Running     0                  8d\niaf-system-elasticsearch-es-data-2                                2/2     Running     0                  16d\niaf-system-kafka-0                                                1/1     Running     0                  36d\niaf-system-kafka-1                                                1/1     Running     0                  36d\niaf-system-kafka-2                                                1/1     Running     0                  36d\niaf-system-zookeeper-0                                            1/1     Running     3 (16d ago)        36d\niaf-system-zookeeper-1                                            1/1     Running     1 (16d ago)        36d\niaf-system-zookeeper-2                                            1/1     Running     1 (16d ago)        36d\nibm-elastic-operator-controller-manager-6f58d78977-9jchj          1/1     Running     7 (66d ago)        111d\n</code></pre>"},{"location":"Container/3-BAI/#bai-jobs","title":"BAI Jobs","text":"<p>Operator creates some jobs for BAI, those jobs must be in <code>Completed</code> state (1/1). On OCP Web Console, navigate to <code>Workloads</code> - <code>Jobs</code> and filter <code>bai</code>.</p> <p></p> <p>Or use <code>oc get job</code> command to check.</p> <pre><code>oc get jobs |grep bai\nicp4adeploy-bai-bpmn                                              1/1           28s        14d\nicp4adeploy-bai-content                                           1/1           28s        14d\nicp4adeploy-bai-icm                                               1/1           27s        14d\nicp4adeploy-bai-setup                                             1/1           2m8s       112d\n</code></pre> <p>Depends on how many event emitters are enabled, the job count may be different.</p> <ul> <li>bai-bpmn: Workflow BPMN event emitter job</li> <li>bai-content: Content emitter job</li> <li>bai-icm: Workflow Case Manager emitter job</li> <li>bai-setup: BAI setup job</li> </ul>"},{"location":"Container/3-BAI/#bai-status-in-configmap","title":"BAI Status in configmap","text":"<p>BAI deploymenmt status is recorded in configmap <code>icp4adeploy-bai-dashboard-status</code> (<code>icp4adeploy</code> is CP4BA deployment name and may be different).</p> <pre><code>data:\n  deploy_ads_dashboard_success: 'True'\n  deploy_bpmn_dashboard_success: 'True'\n  deploy_content_dashboard_success: 'True'\n  deploy_icm_dashboard_success: 'True'\n  deploy_odm_dashboard_success: 'False'\n  deploy_workforce_dashboard_success: 'True'\n</code></pre>"},{"location":"Container/3-BAI/#bai-status-in-cr","title":"BAI Status in CR","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for <code>bai</code>.</p> <pre><code>    bai:\n      bai_deploy_status: Ready\n      conditions:\n        lastTransitionTime: '2023-03-13T04:46:08Z'\n        message: BAI installation finished.\n        reason: BAI-Deployment\n        status: 'True'\n        type: Ready\n      insightsEngine: Ready\n</code></pre>"},{"location":"Container/3-BAI/#iaf-insights-engine","title":"IAF Insights Engine","text":"<p>On OCP Web Console, navigate to <code>Operators</code> - <code>Installed Operators</code>, switch to CP4BA project, find <code>IBM Automation Foundation Insights Engine</code> operator, click it and switch to InsightsEngine view, you will see an InsightsEngine. The condition should be <code>Ready, PrerequisitesReady, InsightsEngineReady</code>.</p> <p></p> <p>Click it and switch to YAML view, check <code>status.conditions</code> section. The status should look like this.</p> <pre><code>  conditions:\n    - message: InsightsEngine instance successfully created\n      reason: InstanceCreated\n      status: 'True'\n      type: Ready\n    - message: ''\n      reason: Successful\n      status: 'True'\n      type: PrerequisitesReady\n    - message: ''\n      reason: Successful\n      status: 'True'\n      type: InsightsEngineReady\n</code></pre>"},{"location":"Container/3-BAI/#flink-web-dashboard","title":"Flink Web Dashboard","text":"<p>BAI uses Apache Flink jobs. The flink jobs may be stopped for some reasons and cause BAI doesn't work. It's very important to check the status via Flink Web Dashboard.</p> <p>You can find Flink Web Dashboard URL from the YAML file above, under <code>status.components.flinkui.endpoints</code> section (this URL is not available in the access info configmap).</p> <pre><code>    flinkUi:\n      endpoints:\n        - authentication:\n            secret:\n              secretName: iaf-insights-engine--7fc4-eve-29ee-ep-admin-user\n            type: BasicSecret\n          caSecret:\n            key: ca.crt\n            secretName: iaf-insights-engine--7fc4-eve-29ee-ep-ss-cacert-kp\n          name: iaf-flink-ui-external\n          scope: External\n          type: API\n          uri: 'https://cpd-ibm-cp4ba.apps.xxx.com/bai-flink-ui'\n</code></pre> <p>If there's no endpoint for Flink Web Dashboard, it may not be enabled. Talk to customer to enable it by following Giving access to the Flink web interface through an Red Hat OpenShift route.</p> <p>The username and password for Flink Web Dashboard can be found in secret <code>iaf-system-elasticsearch-es-default-user</code>.</p> <p>Open Flink Web Dashboard, check the job status.</p> <p></p> <p>If the flink jobs are not running, you need restart the OpenShift jobs (e.g. <code>icp4adeploy-bai-bpmn</code>) by running the command below. Please note you need <code>jq</code> utility to be installed on the machine you are using.</p> <pre><code>oc get job \"&lt;job name&gt;\" -o json | jq 'del(.spec.selector)' | jq 'del(.spec.template.metadata.labels)' | oc replace --force -f - \n</code></pre>"},{"location":"Container/3-BAI/#business-performance-center","title":"Business Performance Center","text":"<p>Find <code>Business Performance Center URL</code> in configmap <code>icp4adeploy-cp4ba-access-info</code>, open it in a browser. Check if it's working.</p> <p></p>"},{"location":"Container/3-BAN/","title":"Business Automation Navigator","text":""},{"location":"Container/3-BAN/#business-automation-navigator","title":"Business Automation Navigator","text":"<p>Business Automation Navigator (BAN) is a browser-based interface where you can work with the business applications you need to complete your tasks.</p> <p>BAN pods:</p> <pre><code>icp4adeploy-navigator-deploy-5f5f4996f9-hm8wn   1/1     Running   0          9d\nicp4adeploy-navigator-deploy-5f5f4996f9-lf7bj   1/1     Running   0          9d\n</code></pre>"},{"location":"Container/3-BAN/#ban-status","title":"BAN Status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for <code>navigator</code>.</p> <pre><code>  \"navigatorDeployment\": \"Ready\",\n  \"navigatorService\": \"Ready\",\n  \"navigatorStorage\": \"Ready\",\n  \"navigatorZenInegration\": \"Ready\",\n</code></pre>"},{"location":"Container/3-BAN/#navigator-desktop","title":"Navigator Desktop","text":"<p>Find <code>navigator-access-info</code> from configmap <code>icp4adeploy-cp4ba-access-info</code> and open the admin desktop (append <code>?desktop=admin</code> to the URL).</p>"},{"location":"Container/3-BAS/","title":"Business Automation Studio","text":""},{"location":"Container/3-BAS/#business-automation-studio","title":"Business Automation Studio","text":"<p>IBM Business Automation Studio is a one-stop shop environment for the IBM Cloud Pak for Business Automation where you automate and digitally transform your business. You can access Workflow Designer, Decision Designer, Document Processing Designer and Application Designer from BAS.</p> <p>Usually BAS is not installed in a production (runtime) environment. Only development environment needs BAS.</p> <p>Here are the BAStudio pods.</p> <pre><code>icp4adeploy-bastudio-deployment-0            1/1     Running     0          9d\nicp4adeploy-bastudio-deployment-1            1/1     Running     0          9d\n</code></pre>"},{"location":"Container/3-BAS/#bastudio-status","title":"BAStudio status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section find <code>bastudio</code>.</p> <pre><code>  \"adminSecret\": \"icp4adeploy-bas-admin-secret\",\n  \"reconcile\": \"Finished\",\n  \"service\": \"Ready\"\n</code></pre>"},{"location":"Container/3-BAS/#access-bastudio","title":"Access BAStudio","text":"<p>Depends on which capabilities are installed, the menus may be unavailable.</p> <p>Find BAStudio URL in configmap <code>icp4adeploy-cp4ba-access-info</code> (<code>bastudio-access-info</code>) and open it in browser. Click the menu on the top left and you can find <code>Business applications</code> and <code>Business automations</code> menu.</p> <p></p> <p>Switch to <code>Business Applications</code> and check if the menus are available.</p> <p></p> <p>Switch to <code>Business Automations</code> and check if the menus are available.</p> <p></p>"},{"location":"Container/3-BAW/","title":"Business Automation Workflow","text":""},{"location":"Container/3-BAW/#business-automation-workflow","title":"Business Automation Workflow","text":""},{"location":"Container/3-BAW/#workflow-deployment-type","title":"Workflow Deployment Type","text":"<p>Business Automation Workflow (BAW) is a platform to create workflow applications to improve productivity. The development environment is called <code>Workflow Authoring</code>, while the runtime environment is called <code>Workflow Runtime</code>. They cannot be deployed into the same project.</p> <p>To check which is installed, find CP4BA CR from OCP Web Console, under <code>status.components</code> look for:</p> <ul> <li><code>workflow-authoring</code>: is the status of Workflow Authoring</li> <li><code>baw</code>: is the status of Workflow Runtime</li> </ul> <p>For example, here you can see Workflow Authoring is not installed.</p> <p><code>workflow-authoring:       adminSecret: ''       reconcile: Finished       service: NotInstalled</code></p> <p>And Workflow Runtime is installed.</p> <p><code>baw:       - bawDeployment: Ready         bawService: Ready         bawZenIntegration: Ready         name: bawins1</code></p> <p>Also, if <code>spec.shared_configuration.sc_optional_components</code> includes <code>baw_authoring</code>, it's Workflow Authoring.</p>"},{"location":"Container/3-BAW/#workflow-cr-configuration","title":"Workflow CR configuration","text":"<p>Find <code>workflow_authoring_configuration</code> (Workflow Authoring) or <code>baw_configuration</code> (Workflow Runtime) in CR. You can find some information there: - the content integration configuration - log settings - liberty_custom_xml - lombardi_custom_xml_secret_name - case integration configuration - database connection information</p> <p>We will come back to this several times.</p> <p>Please note Workflow Runtime configuration is an array, which means customer could deploy multiple Workflow Runtime servers in the same project.</p> <p><code>baw_configuration:       - name: bawins1</code></p> <p>Starts from 23.0.1, Workflow Authoring is integrated into BAS. There are no separate Workflow Authoring pods.</p>"},{"location":"Container/3-BAW/#workflow-deployment-status","title":"Workflow Deployment Status","text":"<p>You can find the Workflow deployment status in CR status section as shown above. Or through a configmap: - <code>icp4adeploy-workflow-authoring-baw-verify-config</code> (for Workflow Authoring, <code>icp4adeploy</code> is CP4BA deployment name and may be different) - <code>icp4adeploy-bawins1-baw-verify-config</code> (for Workflow Runtime, bawinst1 is the BAW server name)</p> <p>Check <code>baw_verified</code>, it should be <code>True</code>.</p> <p><code>data:       baw_verified: 'True'</code></p>"},{"location":"Container/3-BAW/#jvm-properties","title":"JVM Properties","text":"<p>User can define custom properties for JVM using <code>jvm_customize_options</code> in CR, under <code>baw_configuration</code> or <code>workflow_authoring_configuration</code>. For example, this will enable Verbose Garbage Collector log which is useful for performance troubleshooting.</p> <pre><code>  workflow_authoring_configuration:\n    jvm_customize_options: -verbose:gc -Xverbosegclog:dump/verbosegc.log,10,10000\n</code></pre>"},{"location":"Container/3-BAW/#log-trace","title":"Log / trace","text":"<p>Here's an example for log/trace. Turn on the trace when necessary.</p> <pre><code>  workflow_authoring_configuration:\n    logs:\n      console_format: \"json\"\n      console_log_level: \"WARNING\"\n      console_source: \"message,trace,accessLog,ffdc,audit\"\n      message_format: \"SIMPLE\"\n      trace_format: \"ENHANCED\"\n      trace_specification: \"*=warning\"\n      max_files: 10\n      max_filesize: 50\n</code></pre> <p>Open Workflow pods and find <code>logs/application/</code> folder. Please note Workflow Authoring has been merged into Business Automation Studio since 23.0.1 so you need find bastudio pod.</p> <pre><code>sh-4.4$ cd /logs/application/BAS/icp4adeploy-bastudio-deployment-0/\nsh-4.4$ ls\nffdc  liberty-message.log  liberty-message_23.08.10_07.51.39.0.log\n</code></pre> <p>Check the log/trace/FFDC for any exception/error. They may tell us some potential issues.</p>"},{"location":"Container/3-BAW/#datasource","title":"Datasource","text":"<p>Find the database section in CR, under <code>baw_configuration</code> or <code>workflow_authoring_configuration</code> (<code>bastudio_configuration</code> for 23.0.1 and later). </p> <p>Sometimes the database setting will cause issues, e.g. insuffieient connection pool size.</p>"},{"location":"Container/3-BAW/#workflow-custom-properties","title":"Workflow custom properties","text":"<p>Workflow has lots of custom properties. You can find all the parameters which is being used by the server in the workflow pod. It's in <code>/config/TeamWorksConfiguration.running.xml</code>.</p> <pre><code>sh-4.4$ cd /config/\nsh-4.4$ ls\nTeamWorksConfiguration.running.xml\n</code></pre> <p>Record the following parameters for further use.</p> <ul> <li>default-unversioned-po-cache-size</li> <li>default-versioned-po-cache-size</li> <li>branch-context-max-cache-size</li> <li>bpm-repo-max-cached-snapshots</li> <li>classloader-cache-size</li> <li>classloader-resource-map-size</li> <li>cached-scope-size</li> <li>service-result-cache-size</li> <li>web-messaging-push</li> <li>performance-server-communication</li> <li>send-external-email</li> <li>sync-queue-capacity</li> <li>async-queue-capacity</li> <li>bpd-queue-capacity</li> <li>system-queue-capacity</li> </ul> <p>Customer may have changed the properties using 100Custom.xml. This file is created using a secret and you can find the secret name in <code>workflow_authoring_configuration</code> or <code>baw_configuration</code>.</p> <pre><code>    lombardi_custom_xml_secret_name: baw-custom-xml-secret\n</code></pre>"},{"location":"Container/3-BAW/#data-volume","title":"Data Volume","text":"<p>Workflow performance is highly related with data volume in the database. Check the following database tables.</p> <ul> <li>BPM_TASK_INDEX</li> <li>LSW_TASK(BPMDB)</li> <li>BPM_INSTANCE_INDEX</li> <li>LSW_BPD_INSTANCE</li> <li>LSW_TASK_EXECUTION_CONTEXT</li> <li>LSW_TASK_ADDR</li> <li>LSW_BPD_INSTANCE_DATA</li> <li>LSW_DUR_MSG_RECEIVED</li> <li>LSW_USR_GRP_MEM_XREF</li> <li>LSW_PO_VERSIONS</li> <li>LSW_USR_XREF</li> <li>LSW_PO_DEPENDENCY</li> <li>BPM_TASK_INDEX_JOB</li> <li>LSW_USR_GRP_XREF</li> <li>LSW_PO_REFERENCE</li> <li>LSW_SNAPSHOT</li> </ul> <p>Ask customer's DBA to analyze the DB performance.</p>"},{"location":"Container/3-BAW/#process-admin","title":"Process Admin","text":"<p>Workflow has a web application called Process Admin. The URL can be found in the access-info configmap.</p> <pre><code>Business Automation Workflow Process Admin Console: https://cpd-ibm-cp4ba.apps.xxx.com/bas/ProcessAdmin\n</code></pre> <p>Open this URL and log in with Workflow administrator.</p> <p></p>"},{"location":"Container/3-BAW/#cache","title":"Cache","text":"<p>Navigate to <code>Workflow Admin - Manage Caches</code>, record the cache hit ratio.</p> <p></p> <p>If the hit ratio is low we need tune the cache.</p>"},{"location":"Container/3-BAW/#process-monitor","title":"Process Monitor","text":"<p>Navigate to <code>Monitoring - Process Monitor</code>, here we can check the most expensive processes and tasks.</p> <p></p>"},{"location":"Container/3-BAW/#system-maintenance-status","title":"System Maintenance Status","text":"<p>Click <code>System Maintenance Status</code> tab on the top. Here we can also check the data volume.</p> <p></p>"},{"location":"Container/3-BTS/","title":"Business Team Service","text":""},{"location":"Container/3-BTS/#business-team-service","title":"Business Team Service","text":"<p>Business Teams Service (BTS) is a foundation service that is used within Cloud Pak for Business Automation. It has two componets: BTS and its PostgreSQL database.</p> <pre><code>ibm-bts-cnpg-ibm-cp4ba-cp4ba-bts-1                                1/1     Running     0                  108d\nibm-bts-cnpg-ibm-cp4ba-cp4ba-bts-2                                1/1     Running     0                  108d\nibm-bts-cp4ba-bts-316-deployment-7465cffc44-cc647                 1/1     Running     0                  4d16h\nibm-bts-cp4ba-bts-316-deployment-7465cffc44-ljddb                 1/1     Running     0                  4d16h\nibm-bts-cp4ba-bts-316-deployment-7465cffc44-sn7p8                 1/1     Running     0                  4d16h\n</code></pre> <p>On OCP Web Console, navigate to <code>Home</code> - <code>Search</code>. Filter resource <code>BusinessTeamsServices</code> and you will see a BusinessTeamsService called <code>cp4ba-bts</code>.</p> <p></p> <p>Click it and switch to YAML view. Under <code>status</code> section you can see the status of BTS.</p> <pre><code>status:\n  deployStatus: ready\n  endpoints:\n    adminUI: &gt;-\n      https://cpd-ibm-cp4ba.apps.xx.com/teamserver/ui/#/teams\n    apiExplorer: &gt;-\n      https://cpd-ibm-cp4ba.apps.xx.com/teamserver/api/explorer\n    teamsAPI: 'https://cpd-ibm-cp4ba.apps.xx.com/teamserver/rest'\n  lastUpdated: '2023-01-06T05:35:40Z'\n  reason: BTS service ibm-cp4ba/cp4ba-bts ready\n  serviceStatus: ready\n</code></pre>"},{"location":"Container/3-ComponentHealth/","title":"CP4BA Component Health Check","text":""},{"location":"Container/3-ComponentHealth/#cp4ba-component-health-check","title":"CP4BA Component Health Check","text":"<p>In this section we will check the deployed CP4BA capabilities one by one. Pick up the topics based on what have been installed. </p> <p>For more information about the capabilities, please refer to: - Capabilities for production deployments  - Automation Capabilities</p> <p>Before we start, we need find a very important configmap called <code>icp4adeploy-cp4ba-access-info</code> (icp4adeploy is the cluster name and may be different in your environment). It contains all access information for CP4BA deployed in this environment, e.g. - Content Engine admin URL (ACCE) - Content Engine health check URL - Navigator admin desktop - ODM decision center URL - Workflow Process Admin - ...</p> <p>We need check this configmap frequently during the health check.</p>"},{"location":"Container/3-ComponentHealth/#deployment-profile-size","title":"Deployment Profile Size","text":"<p>Operator configures pod replilca size and resources based on the profile size. The settings should match customer's workload. </p> <p>Check the profile sizes to make sure all the settings have consistent values. </p>"},{"location":"Container/3-ComponentHealth/#foundation-components","title":"Foundation Components","text":"<ul> <li>Resource Registry</li> <li>Business Teams Service</li> <li>Business Automation Navigator</li> <li>Business Automation Insights</li> <li>Business Automation Studio</li> </ul>"},{"location":"Container/3-ComponentHealth/#content-components","title":"Content Components","text":"<ul> <li>Enterprise Content Management</li> </ul>"},{"location":"Container/3-ComponentHealth/#workflow-components","title":"Workflow Components","text":"<ul> <li>Business Automation Workflow</li> </ul>"},{"location":"Container/3-ComponentHealth/#decision-components","title":"Decision Components","text":"<ul> <li>Operational Decision Manager</li> <li>Automation Decision Service</li> </ul>"},{"location":"Container/3-ComponentHealth/#low-code-application-components","title":"Low-code Application Components","text":"<ul> <li>Business Automation Application</li> </ul>"},{"location":"Container/3-ComponentHealth/#document-processing-components","title":"Document Processing Components","text":"<ul> <li>Automation Document Processing</li> </ul>"},{"location":"Container/3-DeploymentProfileSize/","title":"Cloud Pak for Business Automation Deployment Profile Size","text":""},{"location":"Container/3-DeploymentProfileSize/#cloud-pak-for-business-automation-deployment-profile-size","title":"Cloud Pak for Business Automation Deployment Profile Size","text":""},{"location":"Container/3-DeploymentProfileSize/#common-services-profile-size","title":"Common Services Profile Size","text":"<p>On OCP Web Console, navigate to <code>Home</code> - <code>Search</code>. Switch to <code>ibm-common-services</code> project (or CP4BA project if there's no separate project for common services). Input \"Common\" in the <code>Resources</code> filter and select <code>CommonService</code>.</p> <p></p> <p>Click the <code>CommonService</code>  and switch to YAML view, under <code>spec</code> you will find <code>size</code> property.</p> <p></p> <p>See Hardware requirements and recommendations for foundational services for details.</p>"},{"location":"Container/3-DeploymentProfileSize/#automationuiconfig-2103-and-220x","title":"AutomationUIConfig (21.0.3 and 22.0.x)","text":"<p>On OCP Web Console, navigate to <code>Operators</code> - <code>Installed Operators</code>. Switch to CP4BA project and find <code>IBM Automation Foundation Core</code> operator. Click it and switch to <code>Automation UIConfig</code> tab.</p> <p></p> <p>Click <code>iaf-system</code> and switch to YAML view. Under <code>spec.zenService</code> section, check if there's a property called <code>scaleConfig</code>. </p> <pre><code>spec:\n  description: automation-ui-config for CP4BA Cartridge\n  license:\n    accept: true\n  tls:\n    certificateSecret:\n      secretName: external-tls-secret\n  version: v1\n  zen: true\n  zenService:\n    iamIntegration: true\n    scaleConfig: medium\n    storageClass: nfs-client\n    zenCoreMetaDbStorageClass: nfs-client\n</code></pre> <p>See Automation Foundation CR and Keys and Default Values for ZenService Custom Resource for details.</p>"},{"location":"Container/3-DeploymentProfileSize/#zenservice-2301-and-later","title":"ZenService (23.0.1 and later)","text":"<p>On OCP Web Console, search for \"ZenService\".</p> <p></p> <p>Click it and switch to YAML view. Under <code>spec</code> find <code>scaleConfig</code> section. Check the value.</p> <p></p>"},{"location":"Container/3-DeploymentProfileSize/#cp4ba-deployment-profile-size","title":"CP4BA deployment profile size","text":"<p>You can define the profile size for CP4BA in the CR, under <code>shared_configuration</code>. See System requirements for details.</p>"},{"location":"Container/3-ECM/","title":"Enterprise Content Manager","text":""},{"location":"Container/3-ECM/#enterprise-content-manager","title":"Enterprise Content Manager","text":"<p>ECM is a comprehensive product and contains some components, like  - Content Process Engine (cpe) - Content Management Interoperability Services (cmis) - Content Search Service (css) - Task Manager (tm) - GraphQL  - External Share - IBM Content Collector for SAP (iccsap) -  It is also used by some capabilities, e.g. Workflow and ADP.</p> <p>The environment may not have all the components deployed. Check <code>sc_deployment_patterns</code> and <code>sc_optional_components</code> in CP4BA CR file for details. Here's the pod list for example.</p> <pre><code>icp4adeploy-cmis-deploy-cff8f46b6-hnhg8                           1/1     Running     0                  17d\nicp4adeploy-cmis-deploy-cff8f46b6-w2gzf                           1/1     Running     0                  17d\nicp4adeploy-cpe-deploy-6d5568499c-cqbl6                           1/1     Running     0                  17d\nicp4adeploy-cpe-deploy-6d5568499c-nf6kd                           1/1     Running     0                  17d\nicp4adeploy-css-deploy-1-5db56d9c4f-w5nqn                         1/1     Running     2                  111d\nicp4adeploy-css-deploy-2-6979878d54-265v4                         1/1     Running     2                  111d\nicp4adeploy-graphql-deploy-756649f84c-pprwh                       1/1     Running     0                  17d\nicp4adeploy-graphql-deploy-756649f84c-slf26                       1/1     Running     0                  17d\nicp4adeploy-graphql-deploy-756649f84c-vjsxd                       1/1     Running     0                  17d\n</code></pre>"},{"location":"Container/3-ECM/#initialization-config","title":"initialization-config","text":"<p>We need first check a configmap <code>icp4adeploy-initialization-config</code> (icp4adeploy is the default ICP4ACluster name and may be different in your environment) records the initialization status for the CPE and Object Stores.</p> <pre><code>  cpe_initialized: 'True'\n  cpe_os_number: '6'\n  css_initialized: 'True'\n  nav_initialized: 'True'\n  nav_platform_conn_created: 'True'\n  nav_platform_conn_with_context: 'True'\n</code></pre> <p>If anything is not true, check the (content) operator log and CPE pod log to find the cause.</p>"},{"location":"Container/3-ECM/#ecm-component-status","title":"ECM component status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for <code>cpe</code>, <code>cmis</code>, <code>css</code>, <code>graphql</code>, <code>tm</code> and <code>extshare</code>.</p> <pre><code>    cpe:\n      cpeStorage: Ready\n      reason: ''\n      message: ''\n      cpeRoute: Ready\n      cpeZenInegration: Ready\n      lastTransitionTime: '2023-03-13T04:46:08Z'\n      cpeJDBCDriver: Ready\n      cpeService: Ready\n      cpeDeployment: Ready\n    cmis:\n      cmisDeployment: Ready\n      cmisRoute: Ready\n      cmisService: Ready\n      cmisStorage: Ready\n      cmisZenInegration: Ready\n    css:\n      cssDeployment: Ready\n      cssService: Ready\n      cssStorage: Ready\n    graphql:\n      graphqlDeployment: Ready\n      graphqlRoute: Ready\n      graphqlService: Ready\n      graphqlStorage: Ready\n    iccsap:\n      iccsapDeployment: NotInstalled\n      iccsapRoute: NotInstalled\n      iccsapService: NotInstalled\n      iccsapStorageCheck: NotInstalled\n    tm:\n      message: ''\n      reason: ''\n      tmDeployment: NotInstalled\n      tmRoute: NotInstalled\n      tmService: NotInstalled\n      tmStorage: NotInstalled\n    extshare:\n      extshareDeployment: NotInstalled\n      extshareRoute: NotInstalled\n      extshareService: NotInstalled\n      extshareStorage: NotInstalled\n</code></pre>"},{"location":"Container/3-ECM/#log-files","title":"log files","text":"<p>For ECM pods, the log is in the directory <code>/opt/ibm/wlp/usr/servers/defaultServer/logs/&lt;pod name&gt;</code>.  For Content Engine (ce) or Process Engine (pe), the logs are in the directory <code>/opt/ibm/wlp/usr/servers/defaultServer/FileNet/icp4adeploy-cpe0x</code>.</p> <p>Sometimes the CE log contains more information than CPE pod log. Check both if you have any issue with CPE.</p>"},{"location":"Container/3-ECM/#ecm-access-urls","title":"ECM Access URLs","text":"<p>Find the following URLs in the configmap <code>icp4adeploy-cp4ba-access-info</code>. Make sure you can open them in browser (not a 404 error).</p> <ul> <li> <p><code>Content Platform Engine administration</code>: CPE ACCE</p> <p></p> </li> <li> <p><code>Content Engine Health Check</code>: This page shows the health information for Content Engine.</p> <p></p> </li> <li> <p><code>Content Platform Engine ping page</code>: this page shows CE startup context.</p> <p></p> </li> <li> <p><code>FileNet Process Services ping page</code></p> <p></p> </li> <li> <p><code>FileNet Process Services details page</code></p> <p></p> </li> <li> <p><code>Content Search Services health check</code>: this page shows the health information for Content Search Service.</p> <p></p> </li> <li> <p><code>Content Services GraphQL</code></p> <p></p> </li> <li> <p><code>Content Management Interoperability Services for CP4BA</code>: this page shows CMIS information.</p> <p></p> </li> </ul>"},{"location":"Container/3-ODM/","title":"Operational Decision Manager","text":""},{"location":"Container/3-ODM/#operational-decision-manager","title":"Operational Decision Manager","text":"<p>Operational Decision Manager (ODM) is the decision management capabilities in CP4BA. It can also be deployed on-premise, or as docker container separately.</p> <p>ODM has Decision Center, Rule Execution Server, Decision Runner and Decision Server Runtime. Here's the pod list for example.</p> <pre><code>icp4adeploy-odm-decisioncenter-84ddc99498-thsgt                   1/1     Running     1 (17d ago)        32d\nicp4adeploy-odm-decisioncenter-84ddc99498-x726g                   1/1     Running     1 (17d ago)        32d\nicp4adeploy-odm-decisionrunner-7994c6bf99-kzvd6                   1/1     Running     0                  32d\nicp4adeploy-odm-decisionrunner-7994c6bf99-t28zn                   1/1     Running     0                  32d\nicp4adeploy-odm-decisionserverconsole-5b67678567-mqx6z            1/1     Running     0                  32d\nicp4adeploy-odm-decisionserverruntime-9578fd548-hbpck             1/1     Running     0                  32d\nicp4adeploy-odm-decisionserverruntime-9578fd548-qsv2d             1/1     Running     0                  32d\nicp4adeploy-odm-decisionserverruntime-9578fd548-z2zm6             1/1     Running     0                  32d\n</code></pre>"},{"location":"Container/3-ODM/#odm-status","title":"ODM status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for <code>odm</code>.</p> <pre><code>    odm:\n      odmDecisionServerConsoleDeployment: Ready\n      odmDecisionServerRuntimeDeployment: Ready\n      odmDecisionRunnerDeployment: Ready\n      odmDecisionCenterService: Ready\n      odmDecisionCenterDeployment: Ready\n      odmDecisionRunnerService: Ready\n      odmDecisionServerConsoleZenIntegration: Ready\n      odmDecisionServerRuntimeZenIntegration: Ready\n      odmOIDCRegistrationJob: Successful\n      odmDecisionServerRuntimeService: Ready\n      odmDecisionRunnerZenIntegration: Ready\n      odmDecisionServerConsoleService: Ready\n      odmDecisionCenterZenIntegration: Ready\n</code></pre>"},{"location":"Container/3-RR/","title":"Resource Registry","text":""},{"location":"Container/3-RR/#resource-registry","title":"Resource Registry","text":"<p>Resource Registry (RR) stores the key/values used by CP4BA components. It is managed by CP4BA operator. Replica number depends on profile size.</p> <pre><code>icp4adeploy-dba-rr-03fcd34f99                                     1/1     Running     0                  15h\nicp4adeploy-dba-rr-186b12152b                                     1/1     Running     0                  7d1h\nicp4adeploy-dba-rr-cd0587269e                                     1/1     Running     0                  4d21h\n</code></pre> <p>If there's no RR pod, please check if CP4BA operator is up and running.</p>"},{"location":"Container/3-RR/#rr-status","title":"RR status","text":"<p>Find CP4BA CR from OCP Web Console, in <code>status.component</code> section look for <code>resource-registry</code>.</p> <pre><code>    resource-registry:\n      rrAdminSecret: resource-registry-admin-secret\n      rrCluster: Ready\n      rrService: Ready\n</code></pre> <p>Also you can find the status in configmap <code>icp4adeploy-rr</code>.</p> <pre><code>data:\n  running: 'true'\n</code></pre>"},{"location":"Container/4-SecurityAndAuth/","title":"Security and Authentication","text":""},{"location":"Container/4-SecurityAndAuth/#4-security-and-authentication","title":"4. Security and Authentication","text":"<p>Find <code>ldap_configuration</code> from CR and check the configurations. Especially if the LDAP server is SSL enabled, check the SSL certificate.</p>"},{"location":"Container/5-Upgrade/","title":"Upgrade and Patch Management","text":""},{"location":"Container/5-Upgrade/#5-upgrade-and-patch-management","title":"5. Upgrade and Patch Management","text":"<p>For the base release (e.g. 23.0.2), follow the <code>Upgrade</code> section of the KC, like:   - 24.0.0: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/24.0.0?topic=automation-upgrading   - 23.0.2: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/23.0.2?topic=automation-upgrading</p> <p>For the interim fix (e.g. 23.0.2 IF006), follow the individual interim fix readme file, like:   - 23.0.2 IF006: https://www.ibm.com/support/pages/node/7156296   - 21.0.3 IF034: https://www.ibm.com/support/pages/node/7156297</p> <p>All the fixes since 21.0.3 are listed on Cloud Pak for Business Automation Fix List.</p>"},{"location":"Container/6-DBStorage/","title":"Database and Storage","text":""},{"location":"Container/6-DBStorage/#6-database-and-storage","title":"6. Database and Storage","text":"<p>TODO: check CR, PV and PVC</p>"},{"location":"Container/7-Troubleshooting/","title":"Troubleshooting","text":""},{"location":"Container/7-Troubleshooting/#7-troubleshooting","title":"7. Troubleshooting","text":"<p>How to check pod logs, etc.</p>"},{"location":"Container/8-BackupRecovery/","title":"Backup and Recovery","text":""},{"location":"Container/8-BackupRecovery/#8-backup-and-recovery","title":"8. Backup and Recovery","text":"<p>Please refer to the Disaster Recovery documents on KC. Make sure you pick up the right version !</p> <ul> <li>21.0.3: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/21.0.3?topic=administering-configuring-components-disaster-recovery</li> <li>23.0.1: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/23.0.1?topic=administering-configuring-components-disaster-recovery</li> <li>23.0.2: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/23.0.2?topic=administering-configuring-components-disaster-recovery</li> <li>24.0.0: https://www.ibm.com/docs/en/cloud-paks/cp-biz-automation/24.0.0?topic=administering-configuring-components-disaster-recovery</li> </ul>"},{"location":"On-premise/","title":"IBM Cloud Pak for Business Automation Health Check (On-premise version)","text":"<p>This page contains the information regarding how to perform the health check for IBM Cloud Pak for Business Automation (CP4BA) on-premise version, for the following components:</p> <ul> <li>Business Automation Workflow</li> <li>Enterprise Content Manager</li> <li>Business Automation Navigator</li> </ul>"},{"location":"On-premise/#common","title":"Common","text":"<ul> <li>0. Preparation</li> <li>1. Infrastructure and Environment</li> </ul>"},{"location":"On-premise/#business-automation-workflow","title":"Business Automation Workflow","text":"<ul> <li>2. Installation and Configuration</li> <li>3. Database</li> <li>4. Security and Authentication</li> <li>5. Logging and Monitoring</li> <li>(6. Upgrade and Patch Management (Coming Soon))</li> <li>(7. Troubleshooting (Coming Soon))</li> <li>(8. Backup and Recovery (Coming Soon))</li> <li>9. BAW Health Check Report Template</li> </ul>"},{"location":"On-premise/#enterprise-content-manager","title":"Enterprise Content Manager","text":"<p>This part contains the health check list specifically for ECM.</p> <p>:construction_worker_man: Work in progress</p>"},{"location":"On-premise/#business-automation-navigator","title":"Business Automation Navigator","text":"<p>This part contains the health check list specifically for Navigator.</p> <p>:construction_worker_man: Work in progress</p>"},{"location":"On-premise/#reference","title":"Reference","text":"<ul> <li>IBM BAW Good Practices: https://www.ibm.com/community/automation/docs/baw/best-practices-recommendations/</li> <li>IBM Business Process Manager Operations Guide: https://www.redbooks.ibm.com/redbooks/pdfs/sg248356.pdf</li> </ul>"},{"location":"On-premise/0-Preparation/","title":"Preparation","text":""},{"location":"On-premise/0-Preparation/#preparation","title":"Preparation","text":"<p>During the health check we need help from:  - OS Administrator for both CP4BA machines and DB machines  - CP4BA admin accounts (e.g. WAS Admin, Workflow Process Admin, FileNet P8Admin, ODM Decision Administrator etc)  - Database Administrator</p> <p>Please talk to customer in advance.</p>"},{"location":"On-premise/0-Preparation/#urls","title":"URLs","text":"<p>Find the example URLs below. The ports may be different. Check with system administrator.</p> <ul> <li>WAS Admin Console: https://hostname:9043/ibm/console</li> <li>BAW Process Admin Console (PAC): https://hostname:9443/ProcessAdmin</li> <li>BAW Performance Admin Console: https://hostname:9443/PerformanceAdmin</li> </ul>"},{"location":"On-premise/1-InfraEnv/","title":"Infrastructure and Environment","text":""},{"location":"On-premise/1-InfraEnv/#1-infrastructure-and-environment","title":"1. Infrastructure and Environment","text":""},{"location":"On-premise/1-InfraEnv/#11-confirm-the-products-installed-is-still-supported","title":"1.1 Confirm the products installed is still supported","text":"<pre><code>$WAS_HOME/bin/versionInfo.sh -fixpacks -ifixes\n</code></pre> <p>Use this command to get the Java version.</p> <pre><code>$WAS_HOME/java/jre/bin/java -version\n</code></pre> <p>Check the following pages to make sure the version installed is still supported. Customer need consider to upgrade to a new release if it's already end of support.</p> <ul> <li>Business Automation Workflow Support Lifecycle</li> <li>FileNet Content Manager Support LifeCycle</li> </ul>"},{"location":"On-premise/1-InfraEnv/#12-check-the-compatibility","title":"1.2 Check the Compatibility","text":"<p>Ask customer to provide supporting software information, including:</p> <ul> <li>LDAP (e.g. Microsoft Active Directory, IBM Security Directory Server) and its version</li> <li>Database (DB2, Oracle, SQLServer etc) and its version</li> </ul> <p>Then review the system requirement, make sure the dependencies (e.g. WAS, Database, LDAP) are compatible.</p> <ul> <li>Busienss Automation Workflow System Requirements</li> <li>FileNet Content Manager System Requirements</li> </ul>"},{"location":"On-premise/1-InfraEnv/#13-verify-hardware-os","title":"1.3 Verify Hardware &amp; OS","text":"<p>Get the following information. You will need OS admin acccount or ask help from OS administrator. Usually the deployment environment will have multiple nodes, please check all the machines.</p> <ul> <li>Hardware, e.g. IBM X3850</li> <li>OS, e.g. Red Hat Enterprise Linux 8.5</li> <li>CPU, e.g. 24 physical cores</li> <li>Memory, e.g. 48GB</li> <li>Disk Space, e.g. 200GB and 40GB left</li> </ul>"},{"location":"On-premise/1-InfraEnv/#14-check-the-environment-variables-such-as-java-version-operating-system-and-database-configurations","title":"1.4 Check the environment variables, such as Java version, Operating System and database configurations","text":""},{"location":"On-premise/1-InfraEnv/#15-ensure-the-necessary-dependencies-like-docker-and-container-orchestration-are-installed-and-functioning-correctly","title":"1.5 Ensure the necessary dependencies, like Docker and container orchestration, are installed and functioning correctly","text":""},{"location":"On-premise/2-BAW-InstallConfig/","title":"Business Automation Workflow Installation and Configuration","text":""},{"location":"On-premise/2-BAW-InstallConfig/#2-business-automation-workflow-installation-and-configuration","title":"2. Business Automation Workflow Installation and Configuration","text":""},{"location":"On-premise/2-BAW-InstallConfig/#21-validate-the-deployment-environment-de-topology-and-pattern","title":"2.1 Validate the Deployment Environment (DE) Topology and Pattern","text":"<p>A network deployment environment can have many topologies. </p>"},{"location":"On-premise/2-BAW-InstallConfig/#de-function","title":"DE Function","text":"<p>From function perspective, we have two types.  - <code>Workflow Center</code> / <code>Process Center</code>: usually used as development environment. Developers can use Process Designer (either Eclipse based or Web based) to develop the process applications  - <code>Workflow Server</code> / <code>Process Server</code>: usually used as UAT and Production environment. No Process Designer available.</p> <p>They are for different purpose. It's not prohibited to use <code>Workflow Center</code> as production envrionment, but it's not recommended.</p> <p>Health Check usually focus on <code>Workflow Server</code> (Production environment).</p>"},{"location":"On-premise/2-BAW-InstallConfig/#features","title":"Features","text":"<p>From feature perspective, we have three types.  - <code>Standard</code>: only BPMN features are enabled.  - <code>Advanced</code>: both BPMN and BPEL features are enabled. It's possible that customer only use one feature.  - <code>Advanced only</code>: only BPEL features are enabled.</p> <p>The health check list will be different for BPMN and BPEL.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#patterns","title":"Patterns","text":"<p>We also have two patterns.  - <code>Single Cluster</code>  - <code>Application, Remote Messaging and Remote Support</code> (aka <code>Golden Cluster</code> or <code>Golden Topology</code>)</p> <p>Old version of Business Process Manager may have other clusters like <code>Remote Web</code>.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#check-the-de","title":"Check the DE","text":"<p>From WAS admin console, navigate to <code>Servers</code> - <code>Deployment Environments</code>, check the DE features and patterns. </p> <p></p> <p>Click the DE name, you will see the DE cluster status.</p> <p></p> <p>On the right side under <code>Additional Properties</code> click <code>Health Center</code>. It will show the health status for all the components.</p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#check-the-topology","title":"Check the Topology","text":"<p>From WAS admin console, navigate to <code>Servers</code> - <code>Clusters</code> - <code>Cluster topology</code>, the cluster topology will be shown on the right side.</p> <p></p> <p>Here we can know:  - How many nodes in the cell  - How many clusters in the cell  - Which nodes are the cluster members running on. For example, the cell has 6 nodes but Messaging cluster only running on 2 nodes.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#recommendations","title":"Recommendations","text":"<ul> <li>Use <code>Workflow Center</code> as Production environment is not recommended. <code>Workflow Center</code> is optimized for development. For more information, please refer to Choosing the deployment environment type.</li> <li><code>Single Cluster</code> topology is not recommended for Production.</li> </ul>"},{"location":"On-premise/2-BAW-InstallConfig/#22-verify-java-virtual-machine-jvm-settings","title":"2.2 Verify Java Virtual Machine (JVM) Settings","text":"<p>The product is written in Java, the performance of the JVM has a significant impact on the performance delivered by these products. JVMs externalize multiple tuning parameters that might be used to improve both authoring and runtime performance. The most important of these parameters are related to garbage collection and setting the Java heap size. </p> <p>In a Cell, there are three types of Java process.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#deployment-manager-dmgr","title":"Deployment Manager (DMGR)","text":"<p>On WAS admin console, navigate to <code>System administration</code> - <code>Deployment Manager</code>, on the right side under <code>Server Infrastructure</code>, expand <code>Java and Process Management</code>, click <code>Process Definition</code>.</p> <p></p> <p>Then on the right side under <code>Additional Properties</code> click <code>Java Virtual Machine</code>.</p> <p></p> <p>Check the <code>Initial heap size</code> and <code>Maximum heap size</code>. Also check if <code>Verbose garbage collection</code> is enabled.</p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#node-agent","title":"Node Agent","text":"<p>Similar with Deployment Manager, on WAS admin console, navigate to <code>System administration</code> - <code>Node agents</code>, select the node agent and follow the same steps above.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#appliation-server","title":"Appliation Server","text":"<p>Similar with Deployment Manager, on WAS admin console, navigate to <code>Servers</code> - <code>Server Types</code> - <code>WebSphere application servers</code>, select the server and follow the same steps above.</p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#recommendations_1","title":"Recommendations","text":"<ul> <li>Use PMI or Health Center described in Health Check Tools to monitor the heaps.</li> <li>Check the monitoring results, increase the heap size accordingly.</li> <li>Verbose GC should always be enabled. It has little performance impact and is very useful to analyse JVM Garbage Collection.</li> <li>For more information about the heap size tuning, please refer to section 4.12 of IBM Business Process Manager V8.5 Performance Tuning and Best Practices.</li> </ul>"},{"location":"On-premise/2-BAW-InstallConfig/#23-thread-pool","title":"2.3 Thread Pool","text":"<p>If a thread pool is used up, new thread will be blocked and impact performance. For BAW we need check the following thread pools.</p> <ul> <li>Default: default thread pool</li> <li>ORB.thread.pool: EJB thread pool, usually used by EJB invocations (e.g. BAW Advanced EBJ API)</li> <li>WebContainer: used by web applications and Rest APIs</li> </ul> <p>Only the thread pools for Application Cluster need to be checked.</p> <p>On WAS Admin Console, navigate to <code>Servers</code> - <code>Server Types</code> - <code>WebSphere application servers</code>, click the application server on the right side.</p> <p></p> <p>Scroll down to the bottom of the page, under <code>Additional Properties</code> click <code>Thread Pools</code>.</p> <p></p> <p>Click one thread pool, check the <code>Minimum Size</code> and <code>Maximum Size</code>.</p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#24-activation-specification","title":"2.4 Activation Specification","text":"<p>For BAW we need check the following activation specifications.</p> <ul> <li>BPEInternalActivationSpec: for BAW Advanced BPEL engine</li> <li>DataDefLoaderActivationSpec: for BAW Standard PDW</li> <li>PostLoadCalculationActivationSpec</li> <li>EventMgrControlActivationSpec: for BAW Standard event manager</li> <li>EventMgrMessageActivationSpec: for BAW Standard event manager</li> </ul> <p>On WAS Admin Console, navigate to <code>Resources</code> - <code>JMS</code> - <code>Activation specification</code>, select an AS on the right side.</p> <p></p> <p>Under <code>Additional</code> check <code>Maximum batch size</code> and <code>Maximum concurrent MDB invocations per endpoint</code>. </p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#25-transaction-service","title":"2.5 Transaction Service","text":"<p>On WAS Admin Console, navigate to <code>Servers</code> - <code>Server Types</code> - <code>WebSphere application servers</code>, click the application server on the right side.</p> <p></p> <p>Under <code>Container Settings</code>, expand <code>Container Services</code> and click <code>Transaction service</code>.</p> <p></p> <p>Check the transaction timeouts. </p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#26-work-manager","title":"2.6 Work Manager","text":"<p>Navigation activities for both the BPEL Engine and the BPMN Engine are typically configured to use a Work Manager. We need check these WMs.</p> <ul> <li>BPENavigationWorkManager: BAW Advacned BPEL engine</li> <li>DefaultWorkManager: BAW Advacned BPEL engine</li> <li>bpm-em-workmanager: BAW Standard BPMN engine</li> </ul> <p>On WAS Admin Console, navigate to <code>Resources</code> - <code>Asynchronous beans</code> - <code>Work managers</code>. Select one WM.</p> <p></p> <p>Check <code>Work request queue size</code>, <code>Minimum number of threads</code> and <code>Maximum number of threads</code>.</p> <p></p>"},{"location":"On-premise/2-BAW-InstallConfig/#27-review-baw-specific-configuration","title":"2.7 Review BAW Specific configuration","text":"<p>Some BAW configuration settings are saved in a set of XML files. Customer may overwrite the default value. We need check those settings.</p> <p>This section is applicable for BAW Standard only. </p> <p>For more information please refer to The 100Custom.xml file and configuration.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#271-baw-configuration-file","title":"2.7.1 BAW Configuration File","text":"<p>All the currently effective configuration settings are stored in a file called <code>TeamWorksConfiguration.running.xml</code> once the BAW server is started. Find it in this folder <code>$BAW_HOME/profiles/&lt;Node Profile&gt;/config/cells/&lt;Cell name&gt;/nodes/&lt;node name&gt;/servers/&lt;server name&gt;/process-&lt;center/server&gt;</code> or search it under <code>$BAW_HOME/profiles</code>. For example, </p> <pre><code>/opt/ibm/bpm/profiles/Node1Profile/config/cells/PCCell1/nodes/Node1/servers/SingleClusterMember1/process-center/TeamWorksConfiguration.running.xml\n</code></pre> <p>Please note the one in folder <code>process-center</code> or <code>process-server</code> is what we need. The one in <code>performance-data-warehouse</code> is for PDW.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#272-cache-settings","title":"2.7.2 Cache Settings","text":"<p>In BAW there are numerous cache and cache-related settings. Find the following configurations in <code>TeamWorksConfiguration.running.xml</code>.</p> <ul> <li>default-unversioned-po-cache-size</li> <li>default-versioned-po-cache-size</li> <li>branch-context-max-cache-size</li> <li>bpm-repo-max-cached-snapshots</li> <li>classloader-cache-size</li> <li>classloader-resource-map-size</li> <li>cached-scope-size</li> <li>service-result-cache-size</li> </ul> <p>(other caches may also impact system performance. To be improved...)</p>"},{"location":"On-premise/2-BAW-InstallConfig/#273-cache-statistics","title":"2.7.3 Cache Statistics","text":"<p>Login to Workflow Process Admin using BAW administrator, navigate to <code>Monitoring</code> - <code>Instrumentation</code>. Find the cache statistics.</p> <ul> <li> <p><code>Cache</code> - <code>Generic Cache</code>, find <code>Hits</code> and <code>Misses</code>.   </p> </li> <li> <p><code>PO Factory</code>, check <code>Cache Hits</code> and <code>Cache Misses</code>.   </p> </li> <li> <p><code>Repository</code>, check <code>Branch context cache hits</code> and <code>Branch context cache misses</code>.   </p> </li> </ul>"},{"location":"On-premise/2-BAW-InstallConfig/#274-performance-data-warehouse","title":"2.7.4 Performance Data Warehouse","text":"<p>BAW provides ways to collect and consume process performance information. Check <code>&lt;performance-server-communication&gt;</code> in <code>TeamWorksConfiguration.running.xml</code>.</p>"},{"location":"On-premise/2-BAW-InstallConfig/#275-event-manager-queues","title":"2.7.5 Event Manager Queues","text":"<p>In <code>TeamWorksConfiguration.running.xml</code> check the following sections.</p> <pre><code>&lt;event-manager&gt;\n  &lt;scheduler&gt;\n    &lt;sync-queue-capacity&gt;\n    &lt;async-queue-capacity&gt;\n    &lt;bpd-queue-capacity&gt;\n    ...\n  &lt;/scheduler&gt;\n&lt;/event-manager&gt;\n</code></pre>"},{"location":"On-premise/2-BAW-InstallConfig/#276-miscellaneous","title":"2.7.6 Miscellaneous","text":"<p>The following properties will also impact performance. Check them.</p> <pre><code>&lt;web-messaging-push&gt;\n&lt;send-external-email&gt;\n</code></pre>"},{"location":"On-premise/2-BAW-InstallConfig/#recommendations_2","title":"Recommendations","text":"<ul> <li>Cache hit ratio usually should &gt; 90%. If it is lower than 50%, there may be a problem.</li> <li>Refer to the following documents for Cache</li> <li>Cache tuning: section 4.4.7 of IBM BPM 8.5 Performance Tuning Redbook </li> <li>Cache and cache-related settings</li> <li>Using process instrumentation data for cache tuning</li> <li>Business data alias cache configuration</li> <li>PDW should be disabled if customer is not using it, to improve performance. Refer to Tracking IBM Business Automation Workflow performance data and Disabling tracking data generation for Business Process Manager (BPM) or Business Automation Workflow (BAW).</li> <li>Refer to the following documents for Event Manager</li> <li>Understanding and Tuning the Event Manager</li> <li>Refer to section 4.3 of IBM BPM 8.5 Performance Tuning Redbook for Process Portal tuning.</li> </ul>"},{"location":"On-premise/3-BAW-DB/","title":"Business Automation Workflow Database","text":""},{"location":"On-premise/3-BAW-DB/#3-business-automation-workflow-database","title":"3. Business Automation Workflow Database","text":""},{"location":"On-premise/3-BAW-DB/#31-database-data-volume-and-performance","title":"3.1 Database Data Volume and Performance","text":"<p>Workflow performance is highly related with data volume in the database. Please ask DBA to run the scripts available on https://github.com/stephan-volz/database-scripts. There are scripts for DB2, Oracle, SQL Server and PostgreSQL.</p> <p>Pay attention to the data volume for the following database tables.</p> <ul> <li>BPM_TASK_INDEX</li> <li>LSW_TASK(BPMDB)</li> <li>BPM_INSTANCE_INDEX</li> <li>LSW_BPD_INSTANCE</li> <li>LSW_TASK_EXECUTION_CONTEXT</li> <li>LSW_TASK_ADDR</li> <li>LSW_BPD_INSTANCE_DATA</li> <li>LSW_DUR_MSG_RECEIVED</li> <li>LSW_USR_GRP_MEM_XREF</li> <li>LSW_PO_VERSIONS</li> <li>LSW_USR_XREF</li> <li>LSW_PO_DEPENDENCY</li> <li>BPM_TASK_INDEX_JOB</li> <li>LSW_USR_GRP_XREF</li> <li>LSW_PO_REFERENCE</li> <li>LSW_SNAPSHOT</li> </ul> <p>Ask customer's DBA to analyze the DB performance. For Oracle, AWR report is very useful.</p>"},{"location":"On-premise/3-BAW-DB/#32-data-source-configuration","title":"3.2 Data Source Configuration","text":"<p>BAW has some data sources. Depends on which pattern was installed, you may not see all of them.</p> <p>Some data sources may point to same database.</p> <ul> <li>jdbc/BPEDB: BAW Advanced engine (BPEL)</li> <li>jdbc/TeamWorksDB: BAW Standard engine (BPMN)</li> <li>jdbc/CommonDB: BAW Advanced Common DB</li> <li>jdbc/mediation/messagelog: BAW Advanced Mediation Message Logger Primitive DB</li> <li>jdbc/ShareDB: Message Engine</li> <li>jdbc/PerformanceDB: BAW Standared Performance Data Warehouse (PDW) DB</li> </ul> <p>The following data sources are for the embedded ECM. Refer to ECM health check document. - jdbc/ECMClientDS: Navigator DB - jdbc/ECMTaskManagerDS: Navigator Task Manager DB - jdbc/ECMDB(XA): ECM DB - jdbc/FNDOSDS(XA): Case Design Object Store DB - jdbc/FNTOSDS(XA): Case Target Object Store DB</p> <p>The following data sources are useless or deprecated. Needn't check them. - jdbc/WPSDB - jdbc/mashupDS</p> <p>On WAS Admin Console, navigate to <code>Resources</code> - <code>JDBC</code> - <code>Data sources</code>.</p> <p></p> <p>Click one data source, on the right side under <code>Addditional Properties</code>, click <code>Connection pool properties</code>.</p> <p></p> <p>Check <code>Maximum connections</code> and <code>Minimum connections</code>. </p> <p></p> <p>Go back to the previous page, under <code>Additional Properties</code>, click <code>WebSphere Application Server data source properties</code>. Check <code>Statement cache size</code>.</p> <p></p>"},{"location":"On-premise/4-BAW-SecurityAndAuth/","title":"Business Automation Workflow Security and Authentication","text":""},{"location":"On-premise/4-BAW-SecurityAndAuth/#4-business-automation-workflow-security-and-authentication","title":"4. Business Automation Workflow Security and Authentication","text":""},{"location":"On-premise/4-BAW-SecurityAndAuth/#41-security-settings","title":"4.1 Security Settings","text":""},{"location":"On-premise/4-BAW-SecurityAndAuth/#42-ldap-settings","title":"4.2 LDAP Settings","text":""},{"location":"On-premise/5-BAW-LogAndMon/","title":"Business Automation Workflow Logging and Monitoring","text":""},{"location":"On-premise/5-BAW-LogAndMon/#6-business-automation-workflow-logging-and-monitoring","title":"6. Business Automation Workflow Logging and Monitoring","text":""},{"location":"On-premise/5-BAW-LogAndMon/#61-logging","title":"6.1 Logging","text":"<p>On WAS admin console, navigate to <code>Troubleshooting</code> - <code>Logs and trace</code>. Click the DMGR, Node Agent or application server.</p> <p></p>"},{"location":"On-premise/5-BAW-LogAndMon/#log","title":"Log","text":"<p>Click <code>JVM Logs</code>. </p> <p></p> <p>Check the <code>File Size</code> and <code>Maximum Number of Historical Log Files</code> settings, for both System.out and System.err.</p> <p></p>"},{"location":"On-premise/5-BAW-LogAndMon/#trace","title":"Trace","text":"<p>Click <code>Diagnostic Trace</code>.</p> <p></p> <p>Check the <code>Maximum File Size</code> and <code>Maximum Number of Historical Files</code>.</p> <p></p> <p>On the right side click <code>Change log detail levels</code>. Check the log level. Please note there are two tabs: <code>Configuration</code> and <code>Runtime</code>. Sometimes they are not same. </p> <ul> <li>Changes for <code>Runtime</code> will take effect immediately without server restart.</li> <li>Changes for <code>Configuration</code> will take effect after server restarts.</li> <li>After server restarts, <code>Runtime</code> changes will be reset to the same value of <code>Configuration</code>.</li> </ul> <p></p>"},{"location":"On-premise/5-BAW-LogAndMon/#recommendations","title":"Recommendations","text":"<ul> <li>Some traces are very heavy (e.g.<code>WLE.*=all</code>. Enabling such trace will hurt performance. Trace should be disabled on production systems unless IBM support asks for that. Set it to <code>*=info</code> or <code>*=disabled</code>.</li> <li>Need keep a number of historical log files, e.g. 20MB * 20. </li> <li>Customer's applications should not produce huge amount of logs into SystemOut.log. It's quite difficult for troubleshooting. If there's a business need, they should consider using third party log libraries (e.g. log4j) to print the logs to a different file.</li> </ul>"},{"location":"On-premise/5-BAW-LogAndMon/#62-server-jvm-logs","title":"6.2 Server (JVM) Logs","text":"<p>Check all the JVM logs, including Deployment Manager, node agent and cluster members (Messaging, Support and Application). Looking for any exception or error.</p>"},{"location":"On-premise/5-BAW-LogAndMon/#recommendations_1","title":"Recommendations","text":"<ul> <li>From the stacktrace we could see whether the exception is from BAW system or from application code. Customer is responsible to fix the application problem. May also need the help from customer's development team.</li> <li>Check for existing fixes. The issue may already have been fixed in a new release.</li> <li>Enable detailed trace if needed. But pay attention that heavy trace will impact performance.</li> </ul>"},{"location":"On-premise/5-BAW-LogAndMon/#63-monitoring","title":"6.3 Monitoring","text":""},{"location":"On-premise/5-BAW-LogAndMon/#631-performance-instrumentation","title":"6.3.1 Performance Instrumentation","text":"<p>Instrumentation log files show every command that is issued on the Process Server and how long each command takes to run. Analysis should be completed in conjunction with thread dumps and log files. Thread dumps show the threads and the full Java stacks of the running components. Log files indicate any errors that might occur during this time. Instrumentation logging helps show where a process is taking time. With the three types of information, you can cross-reference for performance. For example, you have a coach and it takes 20 seconds to run. This coach has multiple activities including reading from an external data source, calling a web service, processing an uploaded file, verifying form data, and sending the data to the Process Server. Collecting instrumentation log files during this time shows each step and how long, in milliseconds, each step takes to run. Thread dumps tell you which thread is running and the full stack of the code path.</p> <p>Open Process Admin Console, navigate to <code>Monitoring</code> - <code>Instrumentation</code>, click <code>Start Logging</code> / <code>Stop Logging</code> to start/stop it.</p> <p></p> <p>The instrumentation data will be saved to a .dat file. For how to decode and read the instrumentation data, please refer to Reading and decoding instrumentation files for WebSphere Lombardi Edition (WLE), and IBM Business Process Manager (BPM) products.</p>"},{"location":"On-premise/5-BAW-LogAndMon/#632-resource-utilization","title":"6.3.2 Resource Utilization","text":"<p>Resource utilization is very important for health check. If customer cannot provide this kind of data, we can monitor the resource utilization during business hours.</p> <p>Different product has different resources to check. Refer to the health check topics for individual products. Use the tools described in Health Check Tools to monitor the resources.</p>"},{"location":"Tools/","title":"Health Check Tools","text":"<p>There are some tools for health check (and also for performance tuning). Prepare them in advance. Some tools need to connect to customer's environments, even run on the machines. Talk to customer to confirm if it's allowed.</p>"},{"location":"Tools/#os-commands","title":"OS commands","text":"<p>Use the commands / tools provided by OS to monitor the system resources.</p>"},{"location":"Tools/#red-hat-linux","title":"Red Hat Linux","text":"<ul> <li>ps</li> <li>top</li> <li>vmstat</li> <li>...</li> </ul>"},{"location":"Tools/#windows","title":"Windows","text":"<ul> <li>Task Manager</li> </ul>"},{"location":"Tools/#nmon","title":"nmon","text":"<p>nmon is a free tool which can monitor lots of performance data like CPU, Memory, Disk I/O etc. It can also generate visualized reports.</p>"},{"location":"Tools/#pmi","title":"PMI","text":"<p>Performance Monitoring Infrastructure (PMI) is the core monitoring infrastructure for WebSphere Application Server (WAS), hence we can use it for WAS based products, e.g. BAW.</p>"},{"location":"Tools/#health-center","title":"Health Center","text":"<p>Health Center is a diagnostic tool for monitoring the status of a running Java or Node.js application.</p> <p>Health Center introduction: https://www.ibm.com/docs/en/mon-diag-tools?topic=center-introduction</p> <p>Using Health Center for Monitoring Business Automation Workflow in CP4BA: https://community.ibm.com/community/user/automation/blogs/florian-leybold1/2021/12/28/using-health-center-for-monitoring-business-automa</p>"},{"location":"Tools/#heap-analyzer-and-emat","title":"Heap Analyzer and EMAT","text":"<p>Tools for JVM heap analysis. Help user to identify potential memory leaks.</p> <p>IBM HeapAnalyzer: https://www.ibm.com/support/pages/ibm-heapanalyzer</p> <p>Eclipse Memory Analyzer Tool with DTFJ and IBM Extensions: https://www.ibm.com/support/pages/eclipse-memory-analyzer-tool-dtfj-and-ibm-extensions</p>"},{"location":"Tools/#thread-dump-analyser","title":"Thread Dump Analyser","text":"<p>Tool for JVM thread dump (javacore) analysis.</p> <p>Problem determination for javacore files from WebSphere Application Server: https://www.ibm.com/support/pages/node/79127</p> <p>IBM Thread and Monitor Dump Analyzer for Java (TMDA): https://www.ibm.com/support/pages/ibm-thread-and-monitor-dump-analyzer-java-tmda</p> <p>Java Core Debugging using IBM Thread and Monitor Dump Analyzer for Java: https://www.ibm.com/support/pages/java-core-debugging-using-ibm-thread-and-monitor-dump-analyzer-java</p>"},{"location":"Tools/#gc-analyser","title":"GC Analyser","text":"<p>Tool to analyze JVM garbage collection.</p> <p>IBM Pattern Modeling and Analysis Tool for Java Garbage Collector (PMAT): https://www.ibm.com/support/pages/ibm-pattern-modeling-and-analysis-tool-java-garbage-collector-pmat</p> <p>Using \"IBM Pattern Modeling and Analysis Tool for Java Garbage Collector\" to Analyze IBM Business Process Manager JVM Memory Usage and Garbage Collections: https://www.ibm.com/support/pages/using-ibm-pattern-modeling-and-analysis-tool-java-garbage-collector-analyze-ibm-business-process-manager-jvm-memory-usage-and-garbage-collections</p>"},{"location":"Tools/PMI/","title":"PMI","text":"<p>A typical web system consists of a web server, application server, and a database. Monitoring and tuning the application server is critical to the overall performance of the web system. Performance Monitoring Infrastructure (PMI) is the core monitoring infrastructure for WebSphere Application Server and WebSphere family products like Portal, Commerce, and so on. The performance data provided by WebSphere PMI helps to monitor and tune the application server performance.</p> <p>For example, PMI provides database connection pool size, Java virtual machine (JVM) garbage collection time, CPU usage etc. This data can be used to understand the runtime resource utilization patterns of the thread pool, connection pool, and so on, and the performance characteristics of the application components like servlets, JavaServer Pages (JSP), and enterprise beans.</p>"},{"location":"Tools/PMI/#how-to-use-pmi","title":"How to use PMI","text":"<p>Login to WAS Admin Console, navigate to <code>Monitoring and Tuning</code> - <code>Performance Viewer</code> - <code>Current activity</code>. Click the server you want to monitor on the right side.</p> <p></p> <p>Expand the <code>Performance Modules</code> in the middle, select the modules you want to monitor, e.g. <code>JVM Runtime</code>, then click <code>View Module(s)</code>. You will see the JVM data, including <code>HeapSize</code>, <code>FreeMemory</code> and <code>UsedMemory</code>.</p> <p></p> <p>You can click <code>View Table</code> to switch to table view.</p> <p></p>"},{"location":"Tools/PMI/#performance-modules","title":"Performance modules","text":"<p>For health check, usually we will check the following modules.</p> <ul> <li>JVM Runtime: check heap usage</li> <li>Thread Pool: Web Container, Work Manager, ORB etc. Check the pool usage.</li> <li>JDBC Connection Pool: check the pool usage.</li> </ul> <p>While different product has different requirements. Refer to health check pages for individual products.</p>"},{"location":"Tools/PMI/#reference","title":"Reference","text":"<ul> <li>Performance Monitoring Infrastructure: https://www.ibm.com/docs/en/was-nd/8.5.5?topic=health-performance-monitoring-infrastructure-pmi</li> </ul>"},{"location":"Tools/nmon/","title":"nmon","text":"<p>Nigel's Monitor (<code>nmon</code>) is a system performance monitoring tool originally developed by IBM for the AIX operating system and later ported for Linux on several CPU architectures.</p> <p>The main benefit of <code>nmon</code> is that it allows you to monitor different aspects of your system, such as CPU utilization, memory, disk busy, network utilization, and more, in a single, concise view. Without <code>nmon</code>, you have to use specialized monitoring tools like <code>top</code> for processes, <code>iostat</code> for disks, and <code>ifstat</code> for the network to monitor various resources. Each of them presents the data differently.</p> <p></p>"},{"location":"Tools/nmon/#download","title":"Download","text":"<p>nmon is packaged in AIX. For Linux please download it from https://nmon.sourceforge.io/pmwiki.php?n=Site.Download. </p> <p>Download <code>nmonchart</code> from https://sourceforge.net/projects/nmon/files/nmonchart40.tar (or any new version).</p> <p>Download <code>nmon analyser</code> from https://nmon.sourceforge.io/pmwiki.php?n=Site.Nmon-Analyser.</p>"},{"location":"Tools/nmon/#using-nmon-interactively","title":"Using nmon interactively","text":"<p>Start <code>nmon</code> and press a key to toggle functions. - <code>c</code> for CPU - <code>m</code> for Memory - <code>d</code> for Disk I/O - <code>n</code> for network - <code>t</code> for Top Processes - <code>k</code> for Kernel - <code>h</code> for help - <code>q</code> to exit</p>"},{"location":"Tools/nmon/#using-nmon-in-batch-mode","title":"Using nmon in batch mode","text":"<p><code>nmon</code> can run in batch mode and save the data to files in CSV format. To run <code>nmon</code> in batch, use the flag <code>-f</code> when launching the application. It has to be the first parameter provided. By default, <code>nmon</code> collects data every five minutes for one day. You can change these default values by specifying the parameters <code>-s</code> for collection interval and <code>-c</code> for the number of snapshots.</p> <pre><code>nmon -f -s5 -c60 -t\n</code></pre> <p>This will enable <code>nmon</code> in batch mode, collecting data every 5 seconds for 60 times (5 minutes), including top processes (<code>-t</code>). The data will be saved to a file with extension .nmon.</p>"},{"location":"Tools/nmon/#visualizing-the-reports","title":"Visualizing the reports","text":""},{"location":"Tools/nmon/#nmonchart","title":"nmonchart","text":"<p><code>nmonchart</code> can parse the report and generate HTML files. Extract the downloaded nmonchart to any folder. First install <code>ksh</code> then run <code>nmonchart</code> together with the .nmon file generated by <code>nomn</code>. It will generate an HTML file.</p> <p></p> <p>Use the buttons on the top to toggle the graphs.</p>"},{"location":"Tools/nmon/#nmon-analyser","title":"nmon analyser","text":"<p>nmon analyser is an Excel spreadsheet which can parse the data file generated by nmon, and create the reports in Excel. Open the spreadsheet, click <code>Analyze nmon data</code> button and select the .nmon file. It will analyze the data and prompt you to save the Excel report. Open the saved Excel file and check the reports.</p> <p></p>"},{"location":"Tools/nmon/#reference","title":"Reference","text":"<ul> <li>nmon homepage: https://nmon.sourceforge.io</li> <li>Original nmon webpage on developerWorks: https://www.ibm.com/support/pages/original-nmon-web-page</li> <li>nmon analyser: https://nmon.sourceforge.io/pmwiki.php?n=Site.Nmon-Analyser</li> <li>Troubleshoot and monitor Linux system performance with nmon: https://www.redhat.com/sysadmin/monitor-linux-performance-nmon</li> </ul>"}]}